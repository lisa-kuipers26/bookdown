<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Databases | Portofolio workflows</title>
  <meta name="description" content="Portflio" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Databases | Portofolio workflows" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Portflio" />
  <meta name="github-repo" content="lisa-kuipers26" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Databases | Portofolio workflows" />
  
  <meta name="twitter:description" content="Portflio" />
  

<meta name="author" content="Lisa Kuipers" />


<meta name="date" content="2022-06-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="het-citeren-van-andere-werken.html"/>
<link rel="next" href="r-packages.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introductie</a></li>
<li class="chapter" data-level="2" data-path="verwerken-van-data.html"><a href="verwerken-van-data.html"><i class="fa fa-check"></i><b>2</b> Verwerken van data</a></li>
<li class="chapter" data-level="3" data-path="open-peer-review.html"><a href="open-peer-review.html"><i class="fa fa-check"></i><b>3</b> Open Peer Review</a><ul>
<li class="chapter" data-level="3.1" data-path="open-peer-review.html"><a href="open-peer-review.html#onderzoek-op-reproduceerbaarheid-beoordelen"><i class="fa fa-check"></i><b>3.1</b> Onderzoek op reproduceerbaarheid beoordelen</a><ul>
<li class="chapter" data-level="3.1.1" data-path="open-peer-review.html"><a href="open-peer-review.html#omschrijving-onderzoek"><i class="fa fa-check"></i><b>3.1.1</b> Omschrijving onderzoek</a></li>
<li class="chapter" data-level="3.1.2" data-path="open-peer-review.html"><a href="open-peer-review.html#beoordeling-artikel"><i class="fa fa-check"></i><b>3.1.2</b> Beoordeling artikel</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="open-peer-review.html"><a href="open-peer-review.html#code-zelf-reproduceren"><i class="fa fa-check"></i><b>3.2</b> Code zelf reproduceren</a><ul>
<li class="chapter" data-level="3.2.1" data-path="open-peer-review.html"><a href="open-peer-review.html#beoordeling-script"><i class="fa fa-check"></i><b>3.2.1</b> Beoordeling script</a></li>
<li class="chapter" data-level="3.2.2" data-path="open-peer-review.html"><a href="open-peer-review.html#probleem-in-script"><i class="fa fa-check"></i><b>3.2.2</b> Probleem in script</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-organiseren.html"><a href="data-organiseren.html"><i class="fa fa-check"></i><b>4</b> Data organiseren</a></li>
<li class="chapter" data-level="5" data-path="cv.html"><a href="cv.html"><i class="fa fa-check"></i><b>5</b> cv</a></li>
<li class="chapter" data-level="6" data-path="het-citeren-van-andere-werken.html"><a href="het-citeren-van-andere-werken.html"><i class="fa fa-check"></i><b>6</b> Het citeren van andere werken</a><ul>
<li class="chapter" data-level="6.1" data-path="het-citeren-van-andere-werken.html"><a href="het-citeren-van-andere-werken.html#bibliografie"><i class="fa fa-check"></i><b>6.1</b> Bibliografie</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="databases.html"><a href="databases.html"><i class="fa fa-check"></i><b>7</b> Databases</a></li>
<li class="chapter" data-level="8" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>8</b> R packages</a></li>
<li class="chapter" data-level="9" data-path="parameters-voor-flexibiliteit.html"><a href="parameters-voor-flexibiliteit.html"><i class="fa fa-check"></i><b>9</b> Parameters voor flexibiliteit</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Portofolio workflows</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="databases" class="section level1 hasAnchor">
<h1><span class="header-section-number">7</span> Databases<a href="databases.html#databases" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Google Dengue Trends (<a href="http://www.google.org/denguetrends" class="uri">http://www.google.org/denguetrends</a>)
Data Source: Google Flu Trends (<a href="http://www.google.org/flutrends" class="uri">http://www.google.org/flutrends</a>)</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="databases.html#cb5-1"></a><span class="kw">library</span>(dslabs)</span>
<span id="cb5-2"><a href="databases.html#cb5-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb5-3"><a href="databases.html#cb5-3"></a></span>
<span id="cb5-4"><a href="databases.html#cb5-4"></a><span class="co">#laden van gapminder</span></span>
<span id="cb5-5"><a href="databases.html#cb5-5"></a>gapminder_df &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>()</span>
<span id="cb5-6"><a href="databases.html#cb5-6"></a></span>
<span id="cb5-7"><a href="databases.html#cb5-7"></a></span>
<span id="cb5-8"><a href="databases.html#cb5-8"></a><span class="co">#tidy maken van data functie</span></span>
<span id="cb5-9"><a href="databases.html#cb5-9"></a>tidy_func &lt;-<span class="st"> </span><span class="cf">function</span>(path, ziekte){</span>
<span id="cb5-10"><a href="databases.html#cb5-10"></a>  read_df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(path, <span class="dt">skip=</span><span class="dv">11</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</span>
<span id="cb5-11"><a href="databases.html#cb5-11"></a>  col_nam &lt;-<span class="st"> </span><span class="kw">colnames</span>(read_df)</span>
<span id="cb5-12"><a href="databases.html#cb5-12"></a>  df_tidy &lt;-<span class="st"> </span>read_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span>col_nam[<span class="op">-</span><span class="dv">1</span>], <span class="dt">names_to=</span><span class="st">&quot;country&quot;</span>, <span class="dt">values_to=</span><span class="kw">paste0</span>(ziekte,<span class="st">&quot;_activity&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb5-13"><a href="databases.html#cb5-13"></a><span class="st">    </span><span class="kw">separate</span>(Date, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>,<span class="st">&quot;day&quot;</span>),<span class="dt">convert =</span> <span class="ot">TRUE</span>)</span>
<span id="cb5-14"><a href="databases.html#cb5-14"></a>}</span>
<span id="cb5-15"><a href="databases.html#cb5-15"></a></span>
<span id="cb5-16"><a href="databases.html#cb5-16"></a>dengue_tidy &lt;-<span class="st"> </span><span class="kw">tidy_func</span>(<span class="st">&quot;data/dengue_data.csv&quot;</span>,<span class="st">&quot;dengue&quot;</span>)</span>
<span id="cb5-17"><a href="databases.html#cb5-17"></a>flu_tidy &lt;-<span class="st"> </span><span class="kw">tidy_func</span>(<span class="st">&quot;data/flu_data.csv&quot;</span>,<span class="st">&quot;flu&quot;</span>)</span>
<span id="cb5-18"><a href="databases.html#cb5-18"></a></span>
<span id="cb5-19"><a href="databases.html#cb5-19"></a><span class="co">#opslaan als RDS</span></span>
<span id="cb5-20"><a href="databases.html#cb5-20"></a><span class="kw">saveRDS</span>(dengue_tidy, <span class="dt">file =</span> <span class="st">&quot;data/dengue.rds&quot;</span>)</span>
<span id="cb5-21"><a href="databases.html#cb5-21"></a><span class="kw">saveRDS</span>(flu_tidy, <span class="dt">file =</span> <span class="st">&quot;data/flu.rds&quot;</span>)</span>
<span id="cb5-22"><a href="databases.html#cb5-22"></a><span class="kw">saveRDS</span>(gapminder_df, <span class="dt">file =</span> <span class="st">&quot;data/gapminder.rds&quot;</span>)</span>
<span id="cb5-23"><a href="databases.html#cb5-23"></a></span>
<span id="cb5-24"><a href="databases.html#cb5-24"></a><span class="co">#opslaan als CSV</span></span>
<span id="cb5-25"><a href="databases.html#cb5-25"></a><span class="kw">write.csv</span>(gapminder_df,<span class="st">&quot;data/gapminder.csv&quot;</span>)</span>
<span id="cb5-26"><a href="databases.html#cb5-26"></a><span class="kw">write.csv</span>(dengue_tidy,<span class="st">&quot;data/dengue.csv&quot;</span>)</span>
<span id="cb5-27"><a href="databases.html#cb5-27"></a><span class="kw">write.csv</span>(flu_tidy,<span class="st">&quot;data/flu.csv&quot;</span>)</span></code></pre></div>
<p>SQL code voor het creëren van een database:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb6-1"><a href="databases.html#cb6-1"></a><span class="kw">CREATE</span> <span class="kw">DATABASE</span> workflowsdb;</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="databases.html#cb7-1"></a><span class="kw">library</span>(DBI)</span>
<span id="cb7-2"><a href="databases.html#cb7-2"></a></span>
<span id="cb7-3"><a href="databases.html#cb7-3"></a><span class="co">#Connectie opzetten</span></span>
<span id="cb7-4"><a href="databases.html#cb7-4"></a>con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(RPostgres<span class="op">::</span><span class="kw">Postgres</span>(), </span>
<span id="cb7-5"><a href="databases.html#cb7-5"></a>                 <span class="dt">dbname =</span> <span class="st">&quot;workflowsdb&quot;</span>, </span>
<span id="cb7-6"><a href="databases.html#cb7-6"></a>                 <span class="dt">host=</span><span class="st">&quot;localhost&quot;</span>, </span>
<span id="cb7-7"><a href="databases.html#cb7-7"></a>                 <span class="dt">port=</span><span class="st">&quot;5432&quot;</span>, </span>
<span id="cb7-8"><a href="databases.html#cb7-8"></a>                 <span class="dt">user=</span><span class="st">&quot;postgres&quot;</span>,</span>
<span id="cb7-9"><a href="databases.html#cb7-9"></a>                 <span class="dt">password=</span><span class="st">&quot;Datascience&quot;</span>)</span>
<span id="cb7-10"><a href="databases.html#cb7-10"></a></span>
<span id="cb7-11"><a href="databases.html#cb7-11"></a><span class="co">#Aanmaken van tabellen in databse</span></span>
<span id="cb7-12"><a href="databases.html#cb7-12"></a><span class="kw">dbWriteTable</span>(con, <span class="st">&quot;flu&quot;</span>, flu_tidy)</span>
<span id="cb7-13"><a href="databases.html#cb7-13"></a><span class="kw">dbWriteTable</span>(con, <span class="st">&quot;dengue&quot;</span>, dengue_tidy)</span>
<span id="cb7-14"><a href="databases.html#cb7-14"></a><span class="kw">dbWriteTable</span>(con, <span class="st">&quot;gapminder&quot;</span>, gapminder_df)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode sql"><code class="sourceCode sql"></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="databases.html#cb9-1"></a><span class="co">#Jaren verwijderen die niet aanwezig zijn in flu en dengue</span></span>
<span id="cb9-2"><a href="databases.html#cb9-2"></a>gapminder_minyear &lt;-<span class="st"> </span>gapminder_df[gapminder_df<span class="op">$</span>year <span class="op">&gt;=</span><span class="st"> </span><span class="kw">min</span>(flu_tidy<span class="op">$</span>year), ]</span>
<span id="cb9-3"><a href="databases.html#cb9-3"></a>gapminder_maxyear &lt;-<span class="st"> </span>gapminder_minyear[gapminder_minyear<span class="op">$</span>year <span class="op">&lt;=</span><span class="st"> </span><span class="kw">max</span>(flu_tidy<span class="op">$</span>year), ]</span>
<span id="cb9-4"><a href="databases.html#cb9-4"></a></span>
<span id="cb9-5"><a href="databases.html#cb9-5"></a><span class="co">#Landen weghalen die niet en flu en dengue aanwezig zijn</span></span>
<span id="cb9-6"><a href="databases.html#cb9-6"></a>landen &lt;-<span class="st"> </span><span class="kw">c</span>(col_dengue[<span class="dv">2</span><span class="op">:</span><span class="dv">11</span>], col_flu[<span class="dv">2</span><span class="op">:</span><span class="dv">30</span>],<span class="dt">recursive=</span><span class="ot">TRUE</span>)</span>
<span id="cb9-7"><a href="databases.html#cb9-7"></a>gapminder_clean &lt;-<span class="st"> </span><span class="kw">subset</span>(gapminder_maxyear, country <span class="op">%in%</span><span class="st"> </span>landen)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="databases.html#cb10-1"></a><span class="co">#Oude tabel verwijderen en nieuwe tabel invoegen</span></span>
<span id="cb10-2"><a href="databases.html#cb10-2"></a><span class="kw">dbRemoveTable</span>(con, <span class="st">&quot;flu&quot;</span>)</span>
<span id="cb10-3"><a href="databases.html#cb10-3"></a><span class="kw">dbWriteTable</span>(con, <span class="st">&quot;gapminder&quot;</span>, gapminder_clean)</span></code></pre></div>
<p>De ondesrtaande code is sql code wat gebruikt wordt om een grote tabel te creëren waar alle data in staat. Er worden left joins gebruikt omdat niet alle landen in beide de dengue dataset en flu dataset voorkomen. Deze informatie van bepaalde datasets kan wel interessant zijn voor het analyseren van data en wordt met de left join een NULL ingevoerd bij de missende data. Voor de rest worden alle kollomen van gapminder gekozen, de dag en maand van flu en de activity van beide flu en dengue. ook worden er joins op year, month en day gedaan. Dit is zodat ze gematched worden in de tabel en laad tijd verminderd bij het sorteren.
Bij het sorteren wordt eerst op het jaartal gesorteerd en daarna op het land om het zo overzichtelijk te houden.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb11-1"><a href="databases.html#cb11-1"></a><span class="kw">SELECT</span></span>
<span id="cb11-2"><a href="databases.html#cb11-2"></a>gapminder.<span class="op">*</span>,</span>
<span id="cb11-3"><a href="databases.html#cb11-3"></a>flu.<span class="ot">&quot;day&quot;</span>,</span>
<span id="cb11-4"><a href="databases.html#cb11-4"></a>flu.<span class="ot">&quot;month&quot;</span>,</span>
<span id="cb11-5"><a href="databases.html#cb11-5"></a>flu.flu_activity,</span>
<span id="cb11-6"><a href="databases.html#cb11-6"></a>dengue.dengue_activity</span>
<span id="cb11-7"><a href="databases.html#cb11-7"></a><span class="kw">FROM</span></span>
<span id="cb11-8"><a href="databases.html#cb11-8"></a>    gapminder </span>
<span id="cb11-9"><a href="databases.html#cb11-9"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> flu  </span>
<span id="cb11-10"><a href="databases.html#cb11-10"></a>  <span class="kw">ON</span> gapminder.<span class="ot">&quot;year&quot;</span>  <span class="op">=</span> flu.<span class="ot">&quot;year&quot;</span> <span class="kw">and</span> gapminder.country <span class="op">=</span> flu.country </span>
<span id="cb11-11"><a href="databases.html#cb11-11"></a><span class="kw">LEFT</span> <span class="kw">join</span> dengue</span>
<span id="cb11-12"><a href="databases.html#cb11-12"></a>    <span class="kw">ON</span> dengue.<span class="ot">&quot;year&quot;</span> <span class="op">=</span> flu.<span class="ot">&quot;year&quot;</span> <span class="kw">and</span> dengue.<span class="ot">&quot;month&quot;</span> <span class="op">=</span> flu.<span class="ot">&quot;month&quot;</span> <span class="kw">and</span> dengue.<span class="ot">&quot;day&quot;</span> <span class="op">=</span> flu.<span class="ot">&quot;day&quot;</span> <span class="kw">and</span> dengue.country <span class="op">=</span> flu.country </span>
<span id="cb11-13"><a href="databases.html#cb11-13"></a><span class="kw">ORDER</span> <span class="kw">BY</span> gapminder.<span class="ot">&quot;year&quot;</span>, gapminder.country  ;</span></code></pre></div>
<p>Deze query wordt uitgevoerd in het programma beaver, hieronder een foto van het dashboard</p>
<p>FOTO !</p>
<p>Door de volgende tekst toe te voegen boven bovenstaande query wordt er een tabel gemaakt genaamd all_data
```{sq; table maken, eval=FALSE}
CREATE TABLE all_data
AS
(…)</p>
<pre><code>
Op deze afbeelding is te zien dat de tabel toegevoegd is aan de database

FOTO !


```r
#Data uit DB ophalen
all_data &lt;- dbReadTable(con, &quot;all_data&quot;)

lifeexp_func &lt;- function(dataset, kolom){
  means &lt;- dataset %&gt;%
    group_by(year) %&gt;% 
    summarise(naam=mean(!! sym(kolom),na.rm=TRUE),
              &quot;mean_life_expectancy&quot;=mean(life_expectancy,na.rm=TRUE))
  
  colnames(means) &lt;- c(&quot;year&quot;,paste0(&quot;mean_&quot;,kolom),&quot;mean_life_expectancy&quot;)
  means

  
}

mean_flu_year &lt;- lifeexp_func(all_data,&quot;flu_activity&quot;)
mean_dengue_year &lt;- lifeexp_func(all_data,&quot;dengue_activity&quot;)


mean_flu_year %&gt;% ggplot(aes(x=year,y=mean_life_expectancy))+
    geom_line()

mean_flu_year %&gt;% ggplot(aes(x=year,y=mean_flu_activity))+
    geom_line()

mean_dengue_year %&gt;% ggplot(aes(x=year,y=mean_dengue_activity))+
    geom_line()

gdp_func &lt;- function(dataset, kolom){
  means &lt;- dataset %&gt;%
    group_by(year) %&gt;% 
    summarise(naam=mean(!! sym(kolom),na.rm=TRUE),
              &quot;GDP&quot;=mean(gdp,na.rm=TRUE))
  
  colnames(means) &lt;- c(&quot;year&quot;,paste0(&quot;mean_&quot;,kolom),&quot;GDP&quot;)
  
  means

  
}

country_data &lt;- all_data %&gt;% filter(year==2008) %&gt;% 
  group_by(country) %&gt;% 
  summarise(mean(flu_activity), max(population),max(gdp)) %&gt;% na.omit()

colnames(country_data) &lt;- c(&quot;country&quot;,&quot;flu_activity&quot;,&quot;population&quot;,&quot;GDP&quot;)

country_data$population &lt;- factor(country_data$population, levels=c(arrange(desc(country_data$population))))


################################################################
library(RColorBrewer)
flu_dengue &lt;- all_data %&gt;% group_by(month, year) %&gt;% 
  na.omit() %&gt;% filter(year!=2002) %&gt;% 
  summarise(mean(dengue_activity, na.rm=TRUE),mean(flu_activity, na.rm=TRUE))

colnames(flu_dengue) &lt;- c(&quot;month&quot;,&quot;year&quot;,&quot;dengue_activity&quot;,&quot;flu_activity&quot;)


activity_years_func &lt;- function(dataset,activity){
  dataset %&gt;% ggplot(aes(x=month,y=dataset[[activity]], group=year, color=factor(year)))+
  geom_line()+
  scale_x_continuous(name=&quot;Month&quot;, breaks=(1:12), limits=c(1, 12))+
  scale_color_brewer(palette = &quot;Set1&quot;)+
  theme_minimal()
}

activity_years_func(&quot;flu_activity&quot;)
activity_years_func(&quot;dengue_activity&quot;)</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="het-citeren-van-andere-werken.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-packages.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
