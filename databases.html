<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>7 Databases | Portofolio data science</title>
<meta name="author" content="Lisa Kuipers">
<meta name="description" content="Om wat verschillende functies van de database te laten zien worden er verschillende datasets ingeladen. Hieronder wordt de data van de dengue en flu google trends tidy gemaakt, door de landnamen...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="7 Databases | Portofolio data science">
<meta property="og:type" content="book">
<meta property="og:description" content="Om wat verschillende functies van de database te laten zien worden er verschillende datasets ingeladen. Hieronder wordt de data van de dengue en flu google trends tidy gemaakt, door de landnamen...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="7 Databases | Portofolio data science">
<meta name="twitter:description" content="Om wat verschillende functies van de database te laten zien worden er verschillende datasets ingeladen. Hieronder wordt de data van de dengue en flu google trends tidy gemaakt, door de landnamen...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="my-styles.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Portofolio data science</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introductie</a></li>
<li><a class="" href="verwerken-van-data.html"><span class="header-section-number">2</span> Verwerken van data</a></li>
<li><a class="" href="open-peer-review.html"><span class="header-section-number">3</span> Open Peer Review</a></li>
<li><a class="" href="data-organiseren.html"><span class="header-section-number">4</span> Data organiseren</a></li>
<li><a class="" href="cv.html"><span class="header-section-number">5</span> cv</a></li>
<li><a class="" href="het-citeren-van-andere-werken.html"><span class="header-section-number">6</span> Het citeren van andere werken</a></li>
<li><a class="active" href="databases.html"><span class="header-section-number">7</span> Databases</a></li>
<li><a class="" href="r-packages.html"><span class="header-section-number">8</span> R packages</a></li>
<li><a class="" href="parameters-voor-flexibiliteit.html"><span class="header-section-number">9</span> Parameters voor flexibiliteit</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="databases" class="section level1">
<h1>
<span class="header-section-number">7</span> Databases<a class="anchor" aria-label="anchor" href="#databases"><i class="fas fa-link"></i></a>
</h1>
<p>Om wat verschillende functies van de database te laten zien worden er verschillende datasets ingeladen. Hieronder wordt de data van de dengue en flu google trends tidy gemaakt, door de landnamen in één kolom te zetten. Ook wordt er een aparte kolom gemaakt met de naam van de ziekte. Voorderest worden ook de datum opgesplitst in dagen, maanden en jaren zodat deze later samengevoegd kunnen worden met de gapminder data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dslabs</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#laden van gapminder</span></span>
<span><span class="va">gapminder_df</span> <span class="op">&lt;-</span> <span class="va">gapminder</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#tidy maken van data functie</span></span>
<span><span class="va">tidy_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">path</span>,<span class="va">name</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">read_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="va">path</span>, skip<span class="op">=</span><span class="fl">11</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">as.data.frame</span></span>
<span>  <span class="va">col_nam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">read_df</span><span class="op">)</span></span>
<span>  <span class="va">read_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="va">col_nam</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, names_to<span class="op">=</span><span class="st">"country"</span>, values_to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"activity"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">Date</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"month"</span>,<span class="st">"day"</span><span class="op">)</span>,convert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="st">"disease"</span><span class="op">=</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dengue_tidy</span> <span class="op">&lt;-</span> <span class="fu">tidy_func</span><span class="op">(</span><span class="st">"data/dengue_data.csv"</span>,<span class="st">"dengue"</span><span class="op">)</span></span>
<span><span class="va">flu_tidy</span> <span class="op">&lt;-</span> <span class="fu">tidy_func</span><span class="op">(</span><span class="st">"data/flu_data.csv"</span>,<span class="st">"flu"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">flu_tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="fl">2005</span><span class="op">)</span></span>
<span><span class="co">#opslaan als RDS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">dengue_tidy</span>, file <span class="op">=</span> <span class="st">"data/dengue_tidy.rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">flu_tidy</span>, file <span class="op">=</span> <span class="st">"data/flu_tidy.rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">gapminder_df</span>, file <span class="op">=</span> <span class="st">"data/gapminder.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#opslaan als CSV</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">gapminder_df</span>,<span class="st">"data/gapminder.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">dengue_tidy</span>,<span class="st">"data/dengue_tidy.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">flu_tidy</span>,<span class="st">"data/flu_tidy.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Er moet een database gemaakt worden om de tabellen op te slaan. Hieronder staat SQL code die ingevoerd kan worden bij het programma dBeaver (of een andere database software) voor het creëren van een database.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb7-1"><a href="databases.html#cb7-1"></a><span class="kw">CREATE</span> <span class="kw">DATABASE</span> workflows;</span></code></pre></div>
<p>Om de database te gebruiken in R wordt er een connectie aangemaakt. Met de connectie kan R code gebruikt worden voor interactie met de database. Dit is handig omdat er dan niet steeds tussen twee programma’s hoeft te switchen. Via de connectie worden de verschillende tabellen ingeladen in de database.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="databases.html#cb8-1"></a><span class="kw">library</span>(DBI)</span>
<span id="cb8-2"><a href="databases.html#cb8-2"></a></span>
<span id="cb8-3"><a href="databases.html#cb8-3"></a><span class="co">#Connectie opzetten</span></span>
<span id="cb8-4"><a href="databases.html#cb8-4"></a>con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(RPostgres<span class="op">::</span><span class="kw">Postgres</span>(), </span>
<span id="cb8-5"><a href="databases.html#cb8-5"></a>                 <span class="dt">dbname =</span> <span class="st">"workflows"</span>, </span>
<span id="cb8-6"><a href="databases.html#cb8-6"></a>                 <span class="dt">host=</span><span class="st">"localhost"</span>, </span>
<span id="cb8-7"><a href="databases.html#cb8-7"></a>                 <span class="dt">port=</span><span class="st">"5432"</span>, </span>
<span id="cb8-8"><a href="databases.html#cb8-8"></a>                 <span class="dt">user=</span><span class="st">"postgres"</span>,</span>
<span id="cb8-9"><a href="databases.html#cb8-9"></a>                 <span class="dt">password=</span><span class="st">"Datascience"</span>)</span>
<span id="cb8-10"><a href="databases.html#cb8-10"></a></span>
<span id="cb8-11"><a href="databases.html#cb8-11"></a><span class="co">#Aanmaken van tabellen in databse</span></span>
<span id="cb8-12"><a href="databases.html#cb8-12"></a><span class="kw">dbWriteTable</span>(con, <span class="st">"flu"</span>, flu_tidy)</span>
<span id="cb8-13"><a href="databases.html#cb8-13"></a><span class="kw">dbWriteTable</span>(con, <span class="st">"dengue"</span>, dengue_tidy)</span>
<span id="cb8-14"><a href="databases.html#cb8-14"></a><span class="kw">dbWriteTable</span>(con, <span class="st">"gapminder"</span>, gapminder_df) B   bBññn ñ</span></code></pre></div>
<p>Om de gapminder wat netter te maken heb ik ervoor gekozen om alvast de landen en jaren die niet in de flu en dengue google trend data voorkomt te verwijderen.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Jaren verwijderen die niet aanwezig zijn in flu en dengue</span></span>
<span><span class="va">gapminder_minyear</span> <span class="op">&lt;-</span> <span class="va">gapminder_df</span><span class="op">[</span><span class="va">gapminder_df</span><span class="op">$</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">flu_tidy</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">gapminder_maxyear</span> <span class="op">&lt;-</span> <span class="va">gapminder_minyear</span><span class="op">[</span><span class="va">gapminder_minyear</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">flu_tidy</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co">#Landen weghalen die niet en flu en dengue aanwezig zijn</span></span>
<span><span class="va">landen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dengue_tidy</span><span class="op">$</span><span class="va">country</span>, <span class="va">flu_tidy</span><span class="op">$</span><span class="va">country</span>,recursive<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">gapminder_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">gapminder_maxyear</span>, <span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">landen</span><span class="op">)</span></span></code></pre></div>
<p>De oude tabel gapminder wordt via de connectie verwijderd en de nette wordt ingevoerd</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Oude tabel verwijderen en nieuwe tabel invoegen</span></span>
<span><span class="fu">dbRemoveTable</span><span class="op">(</span><span class="va">con</span>, <span class="st">"gapminder"</span><span class="op">)</span></span>
<span><span class="fu">dbWriteTable</span><span class="op">(</span><span class="va">con</span>, <span class="st">"gapminder"</span>, <span class="va">gapminder_clean</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb11-1"><a href="databases.html#cb11-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> flu_dengue</span>
<span id="cb11-2"><a href="databases.html#cb11-2"></a><span class="kw">AS</span></span>
<span id="cb11-3"><a href="databases.html#cb11-3"></a></span>
<span id="cb11-4"><a href="databases.html#cb11-4"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb11-5"><a href="databases.html#cb11-5"></a><span class="kw">FROM</span> </span>
<span id="cb11-6"><a href="databases.html#cb11-6"></a>  flu </span>
<span id="cb11-7"><a href="databases.html#cb11-7"></a></span>
<span id="cb11-8"><a href="databases.html#cb11-8"></a><span class="kw">UNION</span> <span class="kw">ALL</span></span>
<span id="cb11-9"><a href="databases.html#cb11-9"></a> </span>
<span id="cb11-10"><a href="databases.html#cb11-10"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb11-11"><a href="databases.html#cb11-11"></a> </span>
<span id="cb11-12"><a href="databases.html#cb11-12"></a><span class="kw">FROM</span></span>
<span id="cb11-13"><a href="databases.html#cb11-13"></a>  dengue</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb12-1"><a href="databases.html#cb12-1"></a><span class="kw">create</span> <span class="kw">table</span> all_data</span>
<span id="cb12-2"><a href="databases.html#cb12-2"></a><span class="kw">as</span></span>
<span id="cb12-3"><a href="databases.html#cb12-3"></a></span>
<span id="cb12-4"><a href="databases.html#cb12-4"></a><span class="kw">select</span> </span>
<span id="cb12-5"><a href="databases.html#cb12-5"></a>gapminder.<span class="op">*</span>,</span>
<span id="cb12-6"><a href="databases.html#cb12-6"></a>flu_dengue.<span class="ot">"month"</span>,</span>
<span id="cb12-7"><a href="databases.html#cb12-7"></a>flu_dengue.<span class="ot">"day"</span>,</span>
<span id="cb12-8"><a href="databases.html#cb12-8"></a>flu_dengue.disease,</span>
<span id="cb12-9"><a href="databases.html#cb12-9"></a>flu_dengue.activity</span>
<span id="cb12-10"><a href="databases.html#cb12-10"></a></span>
<span id="cb12-11"><a href="databases.html#cb12-11"></a><span class="kw">from</span> gapminder </span>
<span id="cb12-12"><a href="databases.html#cb12-12"></a><span class="kw">left</span> <span class="kw">join</span> flu_dengue</span>
<span id="cb12-13"><a href="databases.html#cb12-13"></a><span class="kw">on</span> flu_dengue.<span class="ot">"year"</span> <span class="op">=</span> gapminder.<span class="ot">"year"</span> <span class="kw">and</span> flu_dengue.country <span class="op">=</span> gapminder.country</span>
<span id="cb12-14"><a href="databases.html#cb12-14"></a>    </span>
<span id="cb12-15"><a href="databases.html#cb12-15"></a><span class="kw">ORDER</span> <span class="kw">BY</span> gapminder.<span class="ot">"year"</span>, gapminder.country, flu_dengue.<span class="ot">"month"</span>, flu_dengue.<span class="ot">"day"</span>  ;</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Data uit DB ophalen</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu">dbReadTable</span><span class="op">(</span><span class="va">con</span>, <span class="st">"all_data"</span><span class="op">)</span></span>
<span><span class="co">#Dataset opslaan in data </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">all_data</span>, file<span class="op">=</span><span class="st">"data/all_data.rds"</span><span class="op">)</span></span>
<span><span class="co">#Connectie met database sluiten</span></span>
<span><span class="fu">dbDisconnect</span><span class="op">(</span><span class="va">con</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Data laden voor analyse</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"data/all_data.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span></span>
<span><span class="va">populatie_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dataset</span>,<span class="va">year</span>,<span class="va">name</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">country_data</span> <span class="op">&lt;-</span> <span class="va">dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="fl">2008</span>, <span class="va">disease</span><span class="op">==</span><span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">activity</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">gdp</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">country_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"country"</span>,<span class="st">"activity"</span>,<span class="st">"population"</span>,<span class="st">"GDP"</span><span class="op">)</span></span>
<span>  <span class="va">country_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">country_data</span><span class="op">$</span><span class="va">population</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,<span class="op">]</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">plot1</span> <span class="op">&lt;-</span> <span class="va">country_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">country</span>, y<span class="op">=</span><span class="va">population</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>,vjust<span class="op">=</span><span class="fl">0.3</span>,hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">plot2</span> <span class="op">&lt;-</span> <span class="va">country_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">country</span>, y<span class="op">=</span><span class="va">GDP</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>,vjust<span class="op">=</span><span class="fl">0.3</span>,hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">plot3</span> <span class="op">&lt;-</span> <span class="va">country_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">country</span>, y<span class="op">=</span><span class="va">activity</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>,vjust<span class="op">=</span><span class="fl">0.3</span>,hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">plot1</span>,<span class="va">plot2</span>,<span class="va">plot3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">populatie_func</span><span class="op">(</span><span class="va">all_data</span>, <span class="fl">2008</span>, <span class="st">"flu"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/data%20analyse%20populatie-1.png" width="672"></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">populatie_func</span><span class="op">(</span><span class="va">all_data</span>, <span class="fl">2008</span>, <span class="st">"dengue"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/data%20analyse%20populatie-2.png" width="672"></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Summarise van data per year </span></span>
<span><span class="va">flu_dengue</span> <span class="op">&lt;-</span> <span class="va">all_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">month</span>, <span class="va">year</span>, <span class="va">disease</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">!=</span><span class="fl">2002</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">activity</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">flu_dengue</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"month"</span>,<span class="st">"year"</span>,<span class="st">"disease"</span>, <span class="st">"activity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Functie voor plot van verloop activity</span></span>
<span><span class="va">activity_years_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dataset</span>,<span class="va">name</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">disease</span><span class="op">==</span><span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">month</span>,y<span class="op">=</span><span class="va">activity</span>, group<span class="op">=</span><span class="va">year</span>, color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Month"</span>, breaks<span class="op">=</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">activity_years_func</span><span class="op">(</span><span class="va">flu_dengue</span>,<span class="st">"flu"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672"></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">activity_years_func</span><span class="op">(</span><span class="va">flu_dengue</span>,<span class="st">"dengue"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-5-1.png" width="672"></div>

</div>
  <div class="chapter-nav">
<div class="prev"><a href="het-citeren-van-andere-werken.html"><span class="header-section-number">6</span> Het citeren van andere werken</a></div>
<div class="next"><a href="r-packages.html"><span class="header-section-number">8</span> R packages</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li><a class="nav-link" href="#databases"><span class="header-section-number">7</span> Databases</a></li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Portofolio data science</strong>" was written by Lisa Kuipers. It was last built on 2022-06-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
