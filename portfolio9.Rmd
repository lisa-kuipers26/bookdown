
# Parameters voor flexibiliteit

Parameters in yaml headers kunnen gebruikt worden om je code dynamischer te maken. Het si een snelle manier van variabele veranderen van bijvoorbeel dhet filteren van een dataset.

Hieronder staat een voorbeeld van hoe de yaml header eruit ziet met verschillende parameters. Voor de analyse verderop hebben we dezelfde paramteres gebruitk als in de afbeelding.

```{r yaml, fig.cap="Afbeelding 1: Parameters in de yaml header.", out.width = "200px", echo=FALSE}
knitr::include_graphics(
  here::here(
    "images","yaml.png"))
```

Hieronder staan de parameters in een interactief scherm weergeven. Deze verschijnt wanneer het bestand geknit wordt.
```{r parameters, fig.cap="Afbeelding 2: Parameters bij knitten." , out.width = "200px", echo=FALSE}
knitr::include_graphics(
  here::here(
    "images","para.png"))
```

Hieronder staat de code van het filteren van de de EDCC_daily dataset found at https://www.ecdc.europa.eu/en/covid-19/data. In de datset staan het aantal gevallen en sterfgevallen van COVID-19 uit de periode van 2020 t/m 2022. De parameters die boven staan zijn gebruikt in het filteren. Wanneer iemand van 1 jaar maand of dag de data wilt weergeven kan bij de end en start parameters dezelfde datum ingevoerd worden. Ikzelf heb ervoor gekozen om de hele periode te nemen.

```{r data verwerken}
library(tidyverse)
library(ggplot2)
library(params)
library(stringr)

data_table <- read_csv("data/EDCC_daily.csv")


data_filtered <- data_table %>% filter(year >= params$start_year & year <= params$end_year & countriesAndTerritories == params$country & day %in% c(params$start_day:params$end_day) & month %in% c(params$start_month:params$end_month))

data_filtered$date_range <- paste0(data_filtered$year,sprintf("%02d",data_filtered$month),sprintf("%02d",data_filtered$day)) 


plot_func <- function(dataset,condition){
  dataset %>% ggplot(aes(x=date_range, y=dataset[[condition]]))+
  geom_point()+
  scale_x_discrete(breaks=data_filtered$date_range[seq(1,length(data_filtered$date_range),by=50)])+
  theme(axis.text.x = element_text(angle = 90))+
  labs(x="Date",
       y=condition,
       title = paste("Amount of COVID-19",condition,"from",data_filtered$dateRep[length(data_filtered$dateRep)],"to",data_filtered$dateRep[1],"in Belgium"))
}
```


```{r functie uitvoeren cases, fig.cap= "Figuur 1: Aantal COVID-19 cases van 01/03/2020 t/m 23/05/2022 in belgië. Aantal cases staat op de y-as en de datum als yyyy-mm-dd op de x-as"}
plot_func(data_filtered,"cases")
```

```{r functie uitvoeren deaths,fig.cap= "Figuur 2: Aantal COVID-19 deaths van 01/03/2020 t/m 23/05/2022 in belgië. Aantal cases staat op de y-as en de datum als yyyy-mm-dd op de x-as"}
plot_func(data_filtered,"deaths")
```

Wat interessant is om te zien bij deze figuren dat eigenlijk het aantal doden aan het begin het hoogste lag terwijl het aantal cases niet heel hoog waren. Bij de eerste piek van cases is bij het aantal dode ook een piek te zien ronde dezelfde datum. Daarna zwakt het aantal doden vergeleken met de cases af. Of dit komt doordat mensen met een verzwakt imuunsysteem sneller zijn overleden of omdat vaccinaties werken is natuurlijk niet direct op te maken uit deze data, maar het is wel een interessant verband. 
