<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="3.2 Code zelf reproduceren | Portofolio data science" />
<meta property="og:type" content="book" />

<meta property="og:description" content="Portflio" />
<meta name="github-repo" content="lisa-kuipers26" />

<meta name="author" content="Lisa Kuipers" />

<meta name="date" content="2022-06-28" />


<meta name="description" content="Portflio">

<title>3.2 Code zelf reproduceren | Portofolio data science</title>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<link rel="stylesheet" href="my-styles.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#introductie"><span class="toc-section-number">1</span> Introductie</a></li>
<li><a href="2-verwerken-van-data.html#verwerken-van-data"><span class="toc-section-number">2</span> Verwerken van data</a></li>
<li class="has-sub"><a href="3-open-peer-review.html#open-peer-review"><span class="toc-section-number">3</span> Open Peer Review</a><ul>
<li class="has-sub"><a href="3.1-onderzoek-op-reproduceerbaarheid-beoordelen.html#onderzoek-op-reproduceerbaarheid-beoordelen"><span class="toc-section-number">3.1</span> Onderzoek op reproduceerbaarheid beoordelen</a><ul>
<li><a href="3.1-onderzoek-op-reproduceerbaarheid-beoordelen.html#omschrijving-onderzoek"><span class="toc-section-number">3.1.1</span> Omschrijving onderzoek</a></li>
<li><a href="3.1-onderzoek-op-reproduceerbaarheid-beoordelen.html#beoordeling-artikel"><span class="toc-section-number">3.1.2</span> Beoordeling artikel</a></li>
</ul></li>
<li class="has-sub"><a href="3.2-code-zelf-reproduceren.html#code-zelf-reproduceren"><span class="toc-section-number">3.2</span> Code zelf reproduceren</a><ul>
<li><a href="3.2-code-zelf-reproduceren.html#beoordeling-script"><span class="toc-section-number">3.2.1</span> Beoordeling script</a></li>
<li><a href="3.2-code-zelf-reproduceren.html#probleem-in-script"><span class="toc-section-number">3.2.2</span> Probleem in script</a></li>
</ul></li>
</ul></li>
<li><a href="4-data-organiseren.html#data-organiseren"><span class="toc-section-number">4</span> Data organiseren</a></li>
<li><a href="5-cv.html#cv"><span class="toc-section-number">5</span> cv</a></li>
<li><a href="6-het-citeren-van-andere-werken.html#het-citeren-van-andere-werken"><span class="toc-section-number">6</span> Het citeren van andere werken</a></li>
<li><a href="7-databases.html#databases"><span class="toc-section-number">7</span> Databases</a></li>
<li class="has-sub"><a href="8-r-packages.html#r-packages"><span class="toc-section-number">8</span> R packages</a><ul>
<li><a href="8.1-installeren-van-package.html#installeren-van-package"><span class="toc-section-number">8.1</span> Installeren van package</a></li>
<li><a href="8.2-package-gebruiken.html#package-gebruiken"><span class="toc-section-number">8.2</span> Package gebruiken</a></li>
<li><a href="8.3-functies.html#functies"><span class="toc-section-number">8.3</span> Functies</a></li>
<li><a href="8.4-data.html#data"><span class="toc-section-number">8.4</span> Data</a></li>
<li><a href="8.5-vignette.html#vignette"><span class="toc-section-number">8.5</span> Vignette</a></li>
</ul></li>
<li><a href="9-parameters-voor-flexibiliteit.html#parameters-voor-flexibiliteit"><span class="toc-section-number">9</span> Parameters voor flexibiliteit</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="code-zelf-reproduceren" class="section level2">
<h2><span class="header-section-number">3.2</span> Code zelf reproduceren</h2>
<p>Net is er gekeken reporduceerbaarheid van een primair onderzoek. In dit onderdeel wordt er gekeken naar de reporduceerbaarheid van (R) code.</p>
<p>Data en code van onderstaand onderzoek gebruikt:
Strozza C, Myrskylä M. Monitoring trends and differences in COVID-19 case-fatality rates using decomposition methods: Contributions of age structure and age-specific fatality. PLoS One. 2020 Sep 10;15(9):e0238904. doi: 10.1371/journal.pone.0238904. PMID: 32913365; PMCID: PMC7482960.
<a href="https://pubmed.ncbi.nlm.nih.gov/32913365/" class="uri">https://pubmed.ncbi.nlm.nih.gov/32913365/</a></p>
<p>Link naar de code:
<a href="https://osf.io/g7vjd/" class="uri">https://osf.io/g7vjd/</a></p>
<div id="beoordeling-script" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Beoordeling script</h3>
<p>Het script zelf was goed te lezen. Er waren 4 scripts die elkaar opvolgde, door de getallen in de bestandsnaam was het makkelijk te zien welke als eerst uitgevoerd moest worden. In de scripts zelf stonden genoeg comments om te begrijpen waar elk stuk code voor diende en ziet de code zelf er netjes uit. Ik geef de leesbaarheid dus ook een 5/5</p>
<p>De code was ook goed reproduceerbaar. Er was alleen één probleem wat handmatig opgelost moest worden, dit probleem en hoe deze opgelost is staat beschreven hieronder. Hierdoor krijgt de reproduceerbaarheid een 4/5, want nadat dit probleem opgelost was, konden alle tabellen makkelijk gemaakt worden.</p>
</div>
<div id="probleem-in-script" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Probleem in script</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="3.2-code-zelf-reproduceren.html#cb3-1"></a><span class="co">### Monitoring trends and differences in COVID-19 case fatality  ##############</span></span>
<span id="cb3-2"><a href="3.2-code-zelf-reproduceren.html#cb3-2"></a><span class="co">### rates using decomposition methods: A demographic perspective ##############</span></span>
<span id="cb3-3"><a href="3.2-code-zelf-reproduceren.html#cb3-3"></a></span>
<span id="cb3-4"><a href="3.2-code-zelf-reproduceren.html#cb3-4"></a>  <span class="co">### Last updated: 2020-07-16 09:27:20 CEST</span></span>
<span id="cb3-5"><a href="3.2-code-zelf-reproduceren.html#cb3-5"></a>  </span>
<span id="cb3-6"><a href="3.2-code-zelf-reproduceren.html#cb3-6"></a>  <span class="co">### Contact:</span></span>
<span id="cb3-7"><a href="3.2-code-zelf-reproduceren.html#cb3-7"></a>  <span class="co">### riffe@demogr.mpg.de</span></span>
<span id="cb3-8"><a href="3.2-code-zelf-reproduceren.html#cb3-8"></a>  <span class="co">### acosta@demogr.mpg.de</span></span>
<span id="cb3-9"><a href="3.2-code-zelf-reproduceren.html#cb3-9"></a>  <span class="co">### dudel@demogr.mpg.de</span></span>
<span id="cb3-10"><a href="3.2-code-zelf-reproduceren.html#cb3-10"></a></span>
<span id="cb3-11"><a href="3.2-code-zelf-reproduceren.html#cb3-11"></a></span>
<span id="cb3-12"><a href="3.2-code-zelf-reproduceren.html#cb3-12"></a><span class="co">### Get data ##################################################################</span></span>
<span id="cb3-13"><a href="3.2-code-zelf-reproduceren.html#cb3-13"></a></span>
<span id="cb3-14"><a href="3.2-code-zelf-reproduceren.html#cb3-14"></a>  <span class="co"># Required packages</span></span>
<span id="cb3-15"><a href="3.2-code-zelf-reproduceren.html#cb3-15"></a>  <span class="kw">source</span>((<span class="st">&quot;R/00_functions.R&quot;</span>))</span>
<span id="cb3-16"><a href="3.2-code-zelf-reproduceren.html#cb3-16"></a></span>
<span id="cb3-17"><a href="3.2-code-zelf-reproduceren.html#cb3-17"></a>  <span class="co"># URL + filename</span></span>
<span id="cb3-18"><a href="3.2-code-zelf-reproduceren.html#cb3-18"></a>  </span>
<span id="cb3-19"><a href="3.2-code-zelf-reproduceren.html#cb3-19"></a>  url &lt;-<span class="st"> &#39;https://osf.io/wu5ve//?action=download&#39;</span></span>
<span id="cb3-20"><a href="3.2-code-zelf-reproduceren.html#cb3-20"></a>  filename &lt;-<span class="st"> &#39;Data/Output_10.csv&#39;</span></span>
<span id="cb3-21"><a href="3.2-code-zelf-reproduceren.html#cb3-21"></a>  </span>
<span id="cb3-22"><a href="3.2-code-zelf-reproduceren.html#cb3-22"></a>  <span class="co"># Load data</span></span>
<span id="cb3-23"><a href="3.2-code-zelf-reproduceren.html#cb3-23"></a>  <span class="kw">GET</span>(url, <span class="kw">write_disk</span>(filename, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>))</span>
<span id="cb3-24"><a href="3.2-code-zelf-reproduceren.html#cb3-24"></a>  dat &lt;-<span class="st"> </span><span class="kw">read_csv</span>(filename,<span class="dt">skip=</span><span class="dv">3</span>)</span></code></pre></div>
<p>Bij het uitvoeren van de code hierboven kwam de onderstaande foutmelding:</p>
<div class="figure">
<img src="images/error_r.png" alt="Error in R"  />
<p class="caption">
(#fig:error_r)Error in R
</p>
</div>
<p>In de foutmelding is een html bestand te zien. Dit hoort natuurlijk niet bij een read_csv() functie. In de code wordt het bestand van een online directory gedownload. De URL staat in de code en wanneer deze bezocht werd stond er dit bericht:</p>
<div class="figure">
<img src="images/error_web.png" alt="Error op de webpagina"  />
<p class="caption">
(#fig:error_web)Error op de webpagina
</p>
</div>
<p>Het bestand bevindt zich niet meer op de plek waar de URL naar verwees en kon dus ook niet gedownload worden waardoor de html van de pagina werd overgenomen. Er was echter wel een menu aan de zijkant aanwezig waar het mogelijk is om bij de github van het project te komen. Hier vond ik het output bestand wat nodig is voor de code en heb deze handmatig gedownload en toegevoegd aan de /data directory. Nadat deze in de directory stond kon het script en de rest van de scripts vlekkeloos uitgevoerd worden.
Hieronder staat het script met de aanpassing. De rest van het script kan gevonden worden op de bovenstaande link. De output van het script zijn 6 verschillende excel bestanden met data over het verloop van COVID-19 in 6 verschillende landen.</p>
<hr />
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="3.2-code-zelf-reproduceren.html#cb4-1"></a><span class="co">### Monitoring trends and differences in COVID-19 case fatality  ##############</span></span>
<span id="cb4-2"><a href="3.2-code-zelf-reproduceren.html#cb4-2"></a><span class="co">### rates using decomposition methods: A demographic perspective ##############</span></span>
<span id="cb4-3"><a href="3.2-code-zelf-reproduceren.html#cb4-3"></a></span>
<span id="cb4-4"><a href="3.2-code-zelf-reproduceren.html#cb4-4"></a>  <span class="co">### Last updated: 2020-07-16 09:27:20 CEST</span></span>
<span id="cb4-5"><a href="3.2-code-zelf-reproduceren.html#cb4-5"></a>  </span>
<span id="cb4-6"><a href="3.2-code-zelf-reproduceren.html#cb4-6"></a>  <span class="co">### Contact:</span></span>
<span id="cb4-7"><a href="3.2-code-zelf-reproduceren.html#cb4-7"></a>  <span class="co">### riffe@demogr.mpg.de</span></span>
<span id="cb4-8"><a href="3.2-code-zelf-reproduceren.html#cb4-8"></a>  <span class="co">### acosta@demogr.mpg.de</span></span>
<span id="cb4-9"><a href="3.2-code-zelf-reproduceren.html#cb4-9"></a>  <span class="co">### dudel@demogr.mpg.de</span></span>
<span id="cb4-10"><a href="3.2-code-zelf-reproduceren.html#cb4-10"></a></span>
<span id="cb4-11"><a href="3.2-code-zelf-reproduceren.html#cb4-11"></a></span>
<span id="cb4-12"><a href="3.2-code-zelf-reproduceren.html#cb4-12"></a><span class="co">### Get data ##################################################################</span></span>
<span id="cb4-13"><a href="3.2-code-zelf-reproduceren.html#cb4-13"></a></span>
<span id="cb4-14"><a href="3.2-code-zelf-reproduceren.html#cb4-14"></a>  <span class="co"># Required packages</span></span>
<span id="cb4-15"><a href="3.2-code-zelf-reproduceren.html#cb4-15"></a>  <span class="kw">source</span>((<span class="st">&quot;R/00_functions.R&quot;</span>))</span>
<span id="cb4-16"><a href="3.2-code-zelf-reproduceren.html#cb4-16"></a></span>
<span id="cb4-17"><a href="3.2-code-zelf-reproduceren.html#cb4-17"></a>  <span class="co"># URL + filename</span></span>
<span id="cb4-18"><a href="3.2-code-zelf-reproduceren.html#cb4-18"></a>  filename &lt;-<span class="st"> &#39;data/Output_10.csv&#39;</span></span>
<span id="cb4-19"><a href="3.2-code-zelf-reproduceren.html#cb4-19"></a>  </span>
<span id="cb4-20"><a href="3.2-code-zelf-reproduceren.html#cb4-20"></a>  <span class="co"># Load data</span></span>
<span id="cb4-21"><a href="3.2-code-zelf-reproduceren.html#cb4-21"></a>  dat &lt;-<span class="st"> </span><span class="kw">read_csv</span>(filename,<span class="dt">skip=</span><span class="dv">3</span>)</span>
<span id="cb4-22"><a href="3.2-code-zelf-reproduceren.html#cb4-22"></a>  </span>
<span id="cb4-23"><a href="3.2-code-zelf-reproduceren.html#cb4-23"></a><span class="co">### Edit data (select countries, etc.) ########################################</span></span>
<span id="cb4-24"><a href="3.2-code-zelf-reproduceren.html#cb4-24"></a>  </span>
<span id="cb4-25"><a href="3.2-code-zelf-reproduceren.html#cb4-25"></a>  <span class="co"># Lists of countries and regions</span></span>
<span id="cb4-26"><a href="3.2-code-zelf-reproduceren.html#cb4-26"></a>  countrylist &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;China&quot;</span>,<span class="st">&quot;Germany&quot;</span>,<span class="st">&quot;Italy&quot;</span>,<span class="st">&quot;South Korea&quot;</span>,<span class="st">&quot;Spain&quot;</span>,<span class="st">&quot;USA&quot;</span>)</span>
<span id="cb4-27"><a href="3.2-code-zelf-reproduceren.html#cb4-27"></a>  region &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;All&quot;</span>,<span class="st">&quot;NYC&quot;</span>)</span>
<span id="cb4-28"><a href="3.2-code-zelf-reproduceren.html#cb4-28"></a>  </span>
<span id="cb4-29"><a href="3.2-code-zelf-reproduceren.html#cb4-29"></a>  <span class="co"># Restrict</span></span>
<span id="cb4-30"><a href="3.2-code-zelf-reproduceren.html#cb4-30"></a>  dat &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Country <span class="op">%in%</span><span class="st"> </span>countrylist <span class="op">&amp;</span><span class="st"> </span>Region <span class="op">%in%</span><span class="st"> </span>region)</span>
<span id="cb4-31"><a href="3.2-code-zelf-reproduceren.html#cb4-31"></a>  </span>
<span id="cb4-32"><a href="3.2-code-zelf-reproduceren.html#cb4-32"></a>  <span class="co"># Remove Tests variable</span></span>
<span id="cb4-33"><a href="3.2-code-zelf-reproduceren.html#cb4-33"></a>  dat &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Tests=</span><span class="ot">NULL</span>)</span>
<span id="cb4-34"><a href="3.2-code-zelf-reproduceren.html#cb4-34"></a>  </span>
<span id="cb4-35"><a href="3.2-code-zelf-reproduceren.html#cb4-35"></a>  <span class="co"># Drop if no cases/Deaths</span></span>
<span id="cb4-36"><a href="3.2-code-zelf-reproduceren.html#cb4-36"></a>  dat &lt;-<span class="st"> </span><span class="kw">na.omit</span>(dat)</span>
<span id="cb4-37"><a href="3.2-code-zelf-reproduceren.html#cb4-37"></a>  </span>
<span id="cb4-38"><a href="3.2-code-zelf-reproduceren.html#cb4-38"></a>  </span>
<span id="cb4-39"><a href="3.2-code-zelf-reproduceren.html#cb4-39"></a><span class="co">### Save ######################################################################</span></span>
<span id="cb4-40"><a href="3.2-code-zelf-reproduceren.html#cb4-40"></a>  </span>
<span id="cb4-41"><a href="3.2-code-zelf-reproduceren.html#cb4-41"></a>  <span class="kw">write_csv</span>(dat,<span class="dt">file=</span><span class="st">&quot;Data/inputdata.csv&quot;</span>)</span></code></pre></div>

</div>
</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="3.1-onderzoek-op-reproduceerbaarheid-beoordelen.html"><button class="btn btn-default">Previous</button></a>
<a href="4-data-organiseren.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
