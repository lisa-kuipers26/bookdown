<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Databases | Portofolio data science</title>
  <meta name="description" content="Portflio" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Databases | Portofolio data science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Portflio" />
  <meta name="github-repo" content="lisa-kuipers26" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Databases | Portofolio data science" />
  
  <meta name="twitter:description" content="Portflio" />
  

<meta name="author" content="Lisa Kuipers" />


<meta name="date" content="2022-06-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="het-citeren-van-andere-werken.html"/>
<link rel="next" href="r-packages.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introductie</a></li>
<li class="chapter" data-level="2" data-path="verwerken-van-data.html"><a href="verwerken-van-data.html"><i class="fa fa-check"></i><b>2</b> Verwerken van data</a></li>
<li class="chapter" data-level="3" data-path="open-peer-review.html"><a href="open-peer-review.html"><i class="fa fa-check"></i><b>3</b> Open Peer Review</a><ul>
<li class="chapter" data-level="3.1" data-path="open-peer-review.html"><a href="open-peer-review.html#onderzoek-op-reproduceerbaarheid-beoordelen"><i class="fa fa-check"></i><b>3.1</b> Onderzoek op reproduceerbaarheid beoordelen</a><ul>
<li class="chapter" data-level="3.1.1" data-path="open-peer-review.html"><a href="open-peer-review.html#omschrijving-onderzoek"><i class="fa fa-check"></i><b>3.1.1</b> Omschrijving onderzoek</a></li>
<li class="chapter" data-level="3.1.2" data-path="open-peer-review.html"><a href="open-peer-review.html#beoordeling-artikel"><i class="fa fa-check"></i><b>3.1.2</b> Beoordeling artikel</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="open-peer-review.html"><a href="open-peer-review.html#code-zelf-reproduceren"><i class="fa fa-check"></i><b>3.2</b> Code zelf reproduceren</a><ul>
<li class="chapter" data-level="3.2.1" data-path="open-peer-review.html"><a href="open-peer-review.html#beoordeling-script"><i class="fa fa-check"></i><b>3.2.1</b> Beoordeling script</a></li>
<li class="chapter" data-level="3.2.2" data-path="open-peer-review.html"><a href="open-peer-review.html#probleem-in-script"><i class="fa fa-check"></i><b>3.2.2</b> Probleem in script</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-organiseren.html"><a href="data-organiseren.html"><i class="fa fa-check"></i><b>4</b> Data organiseren</a></li>
<li class="chapter" data-level="5" data-path="cv.html"><a href="cv.html"><i class="fa fa-check"></i><b>5</b> cv</a></li>
<li class="chapter" data-level="6" data-path="het-citeren-van-andere-werken.html"><a href="het-citeren-van-andere-werken.html"><i class="fa fa-check"></i><b>6</b> Het citeren van andere werken</a></li>
<li class="chapter" data-level="7" data-path="databases.html"><a href="databases.html"><i class="fa fa-check"></i><b>7</b> Databases</a></li>
<li class="chapter" data-level="8" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>8</b> R packages</a></li>
<li class="chapter" data-level="9" data-path="parameters-voor-flexibiliteit.html"><a href="parameters-voor-flexibiliteit.html"><i class="fa fa-check"></i><b>9</b> Parameters voor flexibiliteit</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Portofolio data science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="databases" class="section level1 hasAnchor">
<h1><span class="header-section-number">7</span> Databases<a href="databases.html#databases" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Om wat verschillende functies van de database te laten zien worden er verschillende datasets ingeladen. Hieronder wordt de data van de dengue en flu google trends tidy gemaakt, door de landnamen in één kolom te zetten. Ook wordt er een aparte kolom gemaakt met de naam van de ziekte. Voorderest worden ook de datum opgesplitst in dagen, maanden en jaren zodat deze later samengevoegd kunnen worden met de gapminder data.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="databases.html#cb6-1"></a><span class="kw">library</span>(dslabs)</span>
<span id="cb6-2"><a href="databases.html#cb6-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb6-3"><a href="databases.html#cb6-3"></a></span>
<span id="cb6-4"><a href="databases.html#cb6-4"></a><span class="co">#laden van gapminder</span></span>
<span id="cb6-5"><a href="databases.html#cb6-5"></a>gapminder_df &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>()</span>
<span id="cb6-6"><a href="databases.html#cb6-6"></a></span>
<span id="cb6-7"><a href="databases.html#cb6-7"></a></span>
<span id="cb6-8"><a href="databases.html#cb6-8"></a><span class="co">#tidy maken van data functie</span></span>
<span id="cb6-9"><a href="databases.html#cb6-9"></a>tidy_func &lt;-<span class="st"> </span><span class="cf">function</span>(path,name){</span>
<span id="cb6-10"><a href="databases.html#cb6-10"></a>  read_df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(path, <span class="dt">skip=</span><span class="dv">11</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</span>
<span id="cb6-11"><a href="databases.html#cb6-11"></a>  col_nam &lt;-<span class="st"> </span><span class="kw">colnames</span>(read_df)</span>
<span id="cb6-12"><a href="databases.html#cb6-12"></a>  read_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span>col_nam[<span class="op">-</span><span class="dv">1</span>], <span class="dt">names_to=</span><span class="st">&quot;country&quot;</span>, <span class="dt">values_to=</span><span class="kw">paste0</span>(<span class="st">&quot;activity&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb6-13"><a href="databases.html#cb6-13"></a><span class="st">    </span><span class="kw">separate</span>(Date, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>,<span class="st">&quot;day&quot;</span>),<span class="dt">convert =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="st">&quot;disease&quot;</span>=name)</span>
<span id="cb6-14"><a href="databases.html#cb6-14"></a>}</span>
<span id="cb6-15"><a href="databases.html#cb6-15"></a></span>
<span id="cb6-16"><a href="databases.html#cb6-16"></a>dengue_tidy &lt;-<span class="st"> </span><span class="kw">tidy_func</span>(<span class="st">&quot;data/dengue_data.csv&quot;</span>,<span class="st">&quot;dengue&quot;</span>)</span>
<span id="cb6-17"><a href="databases.html#cb6-17"></a>flu_tidy &lt;-<span class="st"> </span><span class="kw">tidy_func</span>(<span class="st">&quot;data/flu_data.csv&quot;</span>,<span class="st">&quot;flu&quot;</span>)</span>
<span id="cb6-18"><a href="databases.html#cb6-18"></a></span>
<span id="cb6-19"><a href="databases.html#cb6-19"></a>flu_tidy <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">filter</span>(year<span class="op">==</span><span class="dv">2005</span>)</span>
<span id="cb6-20"><a href="databases.html#cb6-20"></a><span class="co">#opslaan als RDS</span></span>
<span id="cb6-21"><a href="databases.html#cb6-21"></a><span class="kw">saveRDS</span>(dengue_tidy, <span class="dt">file =</span> <span class="st">&quot;data/dengue_tidy.rds&quot;</span>)</span>
<span id="cb6-22"><a href="databases.html#cb6-22"></a><span class="kw">saveRDS</span>(flu_tidy, <span class="dt">file =</span> <span class="st">&quot;data/flu_tidy.rds&quot;</span>)</span>
<span id="cb6-23"><a href="databases.html#cb6-23"></a><span class="kw">saveRDS</span>(gapminder_df, <span class="dt">file =</span> <span class="st">&quot;data/gapminder.rds&quot;</span>)</span>
<span id="cb6-24"><a href="databases.html#cb6-24"></a></span>
<span id="cb6-25"><a href="databases.html#cb6-25"></a><span class="co">#opslaan als CSV</span></span>
<span id="cb6-26"><a href="databases.html#cb6-26"></a><span class="kw">write.csv</span>(gapminder_df,<span class="st">&quot;data/gapminder.csv&quot;</span>)</span>
<span id="cb6-27"><a href="databases.html#cb6-27"></a><span class="kw">write.csv</span>(dengue_tidy,<span class="st">&quot;data/dengue_tidy.csv&quot;</span>)</span>
<span id="cb6-28"><a href="databases.html#cb6-28"></a><span class="kw">write.csv</span>(flu_tidy,<span class="st">&quot;data/flu_tidy.csv&quot;</span>)</span></code></pre></div>
<p>Er moet een database gemaakt worden om de tabellen op te slaan. Hieronder staat SQL code die ingevoerd kan worden bij het programma dBeaver (of een andere database software) voor het creëren van een database.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb7-1"><a href="databases.html#cb7-1"></a><span class="kw">CREATE</span> <span class="kw">DATABASE</span> workflows;</span></code></pre></div>
<p>Om de database te gebruiken in R wordt er een connectie aangemaakt. Met de connectie kan R code gebruikt worden voor interactie met de database. Dit is handig omdat er dan niet steeds tussen twee programma’s hoeft te switchen. Via de connectie worden de verschillende tabellen ingeladen in de database.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="databases.html#cb8-1"></a><span class="kw">library</span>(DBI)</span>
<span id="cb8-2"><a href="databases.html#cb8-2"></a></span>
<span id="cb8-3"><a href="databases.html#cb8-3"></a><span class="co">#Connectie opzetten</span></span>
<span id="cb8-4"><a href="databases.html#cb8-4"></a>con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(RPostgres<span class="op">::</span><span class="kw">Postgres</span>(), </span>
<span id="cb8-5"><a href="databases.html#cb8-5"></a>                 <span class="dt">dbname =</span> <span class="st">&quot;workflows&quot;</span>, </span>
<span id="cb8-6"><a href="databases.html#cb8-6"></a>                 <span class="dt">host=</span><span class="st">&quot;localhost&quot;</span>, </span>
<span id="cb8-7"><a href="databases.html#cb8-7"></a>                 <span class="dt">port=</span><span class="st">&quot;5432&quot;</span>, </span>
<span id="cb8-8"><a href="databases.html#cb8-8"></a>                 <span class="dt">user=</span><span class="st">&quot;postgres&quot;</span>,</span>
<span id="cb8-9"><a href="databases.html#cb8-9"></a>                 <span class="dt">password=</span><span class="st">&quot;Datascience&quot;</span>)</span>
<span id="cb8-10"><a href="databases.html#cb8-10"></a></span>
<span id="cb8-11"><a href="databases.html#cb8-11"></a><span class="co">#Aanmaken van tabellen in databse</span></span>
<span id="cb8-12"><a href="databases.html#cb8-12"></a><span class="kw">dbWriteTable</span>(con, <span class="st">&quot;flu&quot;</span>, flu_tidy)</span>
<span id="cb8-13"><a href="databases.html#cb8-13"></a><span class="kw">dbWriteTable</span>(con, <span class="st">&quot;dengue&quot;</span>, dengue_tidy)</span>
<span id="cb8-14"><a href="databases.html#cb8-14"></a><span class="kw">dbWriteTable</span>(con, <span class="st">&quot;gapminder&quot;</span>, gapminder_df) B   bBññn ñ</span></code></pre></div>
<p>Om de gapminder wat netter te maken heb ik ervoor gekozen om alvast de landen en jaren die niet in de flu en dengue google trend data voorkomt te verwijderen.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="databases.html#cb9-1"></a><span class="co">#Jaren verwijderen die niet aanwezig zijn in flu en dengue</span></span>
<span id="cb9-2"><a href="databases.html#cb9-2"></a>gapminder_minyear &lt;-<span class="st"> </span>gapminder_df[gapminder_df<span class="op">$</span>year <span class="op">&gt;=</span><span class="st"> </span><span class="kw">min</span>(flu_tidy<span class="op">$</span>year), ]</span>
<span id="cb9-3"><a href="databases.html#cb9-3"></a>gapminder_maxyear &lt;-<span class="st"> </span>gapminder_minyear[gapminder_minyear<span class="op">$</span>year <span class="op">&lt;=</span><span class="st"> </span><span class="kw">max</span>(flu_tidy<span class="op">$</span>year), ]</span>
<span id="cb9-4"><a href="databases.html#cb9-4"></a></span>
<span id="cb9-5"><a href="databases.html#cb9-5"></a><span class="co">#Landen weghalen die niet en flu en dengue aanwezig zijn</span></span>
<span id="cb9-6"><a href="databases.html#cb9-6"></a>landen &lt;-<span class="st"> </span><span class="kw">c</span>(dengue_tidy<span class="op">$</span>country, flu_tidy<span class="op">$</span>country,<span class="dt">recursive=</span><span class="ot">TRUE</span>)</span>
<span id="cb9-7"><a href="databases.html#cb9-7"></a>gapminder_clean &lt;-<span class="st"> </span><span class="kw">subset</span>(gapminder_maxyear, country <span class="op">%in%</span><span class="st"> </span>landen)</span></code></pre></div>
<p>De oude tabel gapminder wordt via de connectie verwijderd en de nette wordt ingevoerd</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="databases.html#cb10-1"></a><span class="co">#Oude tabel verwijderen en nieuwe tabel invoegen</span></span>
<span id="cb10-2"><a href="databases.html#cb10-2"></a><span class="kw">dbRemoveTable</span>(con, <span class="st">&quot;gapminder&quot;</span>)</span>
<span id="cb10-3"><a href="databases.html#cb10-3"></a><span class="kw">dbWriteTable</span>(con, <span class="st">&quot;gapminder&quot;</span>, gapminder_clean)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb11-1"><a href="databases.html#cb11-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> flu_dengue</span>
<span id="cb11-2"><a href="databases.html#cb11-2"></a><span class="kw">AS</span></span>
<span id="cb11-3"><a href="databases.html#cb11-3"></a></span>
<span id="cb11-4"><a href="databases.html#cb11-4"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb11-5"><a href="databases.html#cb11-5"></a><span class="kw">FROM</span> </span>
<span id="cb11-6"><a href="databases.html#cb11-6"></a>  flu </span>
<span id="cb11-7"><a href="databases.html#cb11-7"></a></span>
<span id="cb11-8"><a href="databases.html#cb11-8"></a><span class="kw">UNION</span> <span class="kw">ALL</span></span>
<span id="cb11-9"><a href="databases.html#cb11-9"></a> </span>
<span id="cb11-10"><a href="databases.html#cb11-10"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb11-11"><a href="databases.html#cb11-11"></a> </span>
<span id="cb11-12"><a href="databases.html#cb11-12"></a><span class="kw">FROM</span></span>
<span id="cb11-13"><a href="databases.html#cb11-13"></a>  dengue</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb12-1"><a href="databases.html#cb12-1"></a><span class="kw">create</span> <span class="kw">table</span> all_data</span>
<span id="cb12-2"><a href="databases.html#cb12-2"></a><span class="kw">as</span></span>
<span id="cb12-3"><a href="databases.html#cb12-3"></a></span>
<span id="cb12-4"><a href="databases.html#cb12-4"></a><span class="kw">select</span> </span>
<span id="cb12-5"><a href="databases.html#cb12-5"></a>gapminder.<span class="op">*</span>,</span>
<span id="cb12-6"><a href="databases.html#cb12-6"></a>flu_dengue.<span class="ot">&quot;month&quot;</span>,</span>
<span id="cb12-7"><a href="databases.html#cb12-7"></a>flu_dengue.<span class="ot">&quot;day&quot;</span>,</span>
<span id="cb12-8"><a href="databases.html#cb12-8"></a>flu_dengue.disease,</span>
<span id="cb12-9"><a href="databases.html#cb12-9"></a>flu_dengue.activity</span>
<span id="cb12-10"><a href="databases.html#cb12-10"></a></span>
<span id="cb12-11"><a href="databases.html#cb12-11"></a><span class="kw">from</span> gapminder </span>
<span id="cb12-12"><a href="databases.html#cb12-12"></a><span class="kw">left</span> <span class="kw">join</span> flu_dengue</span>
<span id="cb12-13"><a href="databases.html#cb12-13"></a><span class="kw">on</span> flu_dengue.<span class="ot">&quot;year&quot;</span> <span class="op">=</span> gapminder.<span class="ot">&quot;year&quot;</span> <span class="kw">and</span> flu_dengue.country <span class="op">=</span> gapminder.country</span>
<span id="cb12-14"><a href="databases.html#cb12-14"></a>    </span>
<span id="cb12-15"><a href="databases.html#cb12-15"></a><span class="kw">ORDER</span> <span class="kw">BY</span> gapminder.<span class="ot">&quot;year&quot;</span>, gapminder.country, flu_dengue.<span class="ot">&quot;month&quot;</span>, flu_dengue.<span class="ot">&quot;day&quot;</span>  ;</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="databases.html#cb13-1"></a><span class="co">#Data uit DB ophalen</span></span>
<span id="cb13-2"><a href="databases.html#cb13-2"></a>all_data &lt;-<span class="st"> </span><span class="kw">dbReadTable</span>(con, <span class="st">&quot;all_data&quot;</span>)</span>
<span id="cb13-3"><a href="databases.html#cb13-3"></a><span class="co">#Dataset opslaan in data </span></span>
<span id="cb13-4"><a href="databases.html#cb13-4"></a><span class="kw">saveRDS</span>(all_data, <span class="dt">file=</span><span class="st">&quot;data/all_data.rds&quot;</span>)</span>
<span id="cb13-5"><a href="databases.html#cb13-5"></a><span class="co">#Connectie met database sluiten</span></span>
<span id="cb13-6"><a href="databases.html#cb13-6"></a><span class="kw">dbDisconnect</span>(con) </span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="databases.html#cb14-1"></a><span class="co">#Data laden voor analyse</span></span>
<span id="cb14-2"><a href="databases.html#cb14-2"></a>all_data &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data/all_data.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="databases.html#cb15-1"></a><span class="kw">library</span>(gridExtra)</span>
<span id="cb15-2"><a href="databases.html#cb15-2"></a></span>
<span id="cb15-3"><a href="databases.html#cb15-3"></a>populatie_func &lt;-<span class="st"> </span><span class="cf">function</span>(dataset,year,name){</span>
<span id="cb15-4"><a href="databases.html#cb15-4"></a>  country_data &lt;-<span class="st"> </span>dataset <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year<span class="op">==</span><span class="dv">2008</span>, disease<span class="op">==</span>name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-5"><a href="databases.html#cb15-5"></a><span class="st">    </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-6"><a href="databases.html#cb15-6"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="kw">mean</span>(activity, <span class="dt">na.rm=</span><span class="ot">TRUE</span>), <span class="kw">max</span>(population),<span class="kw">max</span>(gdp))</span>
<span id="cb15-7"><a href="databases.html#cb15-7"></a>  <span class="kw">colnames</span>(country_data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;country&quot;</span>,<span class="st">&quot;activity&quot;</span>,<span class="st">&quot;population&quot;</span>,<span class="st">&quot;GDP&quot;</span>)</span>
<span id="cb15-8"><a href="databases.html#cb15-8"></a>  country_data[<span class="kw">order</span>(country_data<span class="op">$</span>population, <span class="dt">decreasing=</span><span class="ot">TRUE</span>),]</span>
<span id="cb15-9"><a href="databases.html#cb15-9"></a>  </span>
<span id="cb15-10"><a href="databases.html#cb15-10"></a>  </span>
<span id="cb15-11"><a href="databases.html#cb15-11"></a>  plot1 &lt;-<span class="st"> </span>country_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>country, <span class="dt">y=</span>population))<span class="op">+</span></span>
<span id="cb15-12"><a href="databases.html#cb15-12"></a><span class="st">    </span><span class="kw">geom_col</span>()<span class="op">+</span></span>
<span id="cb15-13"><a href="databases.html#cb15-13"></a><span class="st">    </span><span class="kw">theme_minimal</span>()<span class="op">+</span></span>
<span id="cb15-14"><a href="databases.html#cb15-14"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">vjust=</span><span class="fl">0.3</span>,<span class="dt">hjust=</span><span class="dv">1</span>))</span>
<span id="cb15-15"><a href="databases.html#cb15-15"></a>  plot2 &lt;-<span class="st"> </span>country_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>country, <span class="dt">y=</span>GDP))<span class="op">+</span></span>
<span id="cb15-16"><a href="databases.html#cb15-16"></a><span class="st">    </span><span class="kw">geom_col</span>()<span class="op">+</span></span>
<span id="cb15-17"><a href="databases.html#cb15-17"></a><span class="st">    </span><span class="kw">theme_minimal</span>()<span class="op">+</span></span>
<span id="cb15-18"><a href="databases.html#cb15-18"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">vjust=</span><span class="fl">0.3</span>,<span class="dt">hjust=</span><span class="dv">1</span>))</span>
<span id="cb15-19"><a href="databases.html#cb15-19"></a>  plot3 &lt;-<span class="st"> </span>country_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>country, <span class="dt">y=</span>activity))<span class="op">+</span></span>
<span id="cb15-20"><a href="databases.html#cb15-20"></a><span class="st">    </span><span class="kw">geom_col</span>()<span class="op">+</span></span>
<span id="cb15-21"><a href="databases.html#cb15-21"></a><span class="st">    </span><span class="kw">theme_minimal</span>()<span class="op">+</span></span>
<span id="cb15-22"><a href="databases.html#cb15-22"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">vjust=</span><span class="fl">0.3</span>,<span class="dt">hjust=</span><span class="dv">1</span>))</span>
<span id="cb15-23"><a href="databases.html#cb15-23"></a>  </span>
<span id="cb15-24"><a href="databases.html#cb15-24"></a>  <span class="kw">grid.arrange</span>(plot1,plot2,plot3)</span>
<span id="cb15-25"><a href="databases.html#cb15-25"></a>}</span>
<span id="cb15-26"><a href="databases.html#cb15-26"></a></span>
<span id="cb15-27"><a href="databases.html#cb15-27"></a><span class="kw">populatie_func</span>(all_data, <span class="dv">2008</span>, <span class="st">&quot;flu&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/data%20analyse%20populatie-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="databases.html#cb16-1"></a><span class="kw">populatie_func</span>(all_data, <span class="dv">2008</span>, <span class="st">&quot;dengue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/data%20analyse%20populatie-2.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="databases.html#cb17-1"></a><span class="kw">library</span>(RColorBrewer)</span>
<span id="cb17-2"><a href="databases.html#cb17-2"></a></span>
<span id="cb17-3"><a href="databases.html#cb17-3"></a><span class="co">#Summarise van data per year </span></span>
<span id="cb17-4"><a href="databases.html#cb17-4"></a>flu_dengue &lt;-<span class="st"> </span>all_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(month, year, disease) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-5"><a href="databases.html#cb17-5"></a><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year<span class="op">!=</span><span class="dv">2002</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-6"><a href="databases.html#cb17-6"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="kw">mean</span>(activity))</span>
<span id="cb17-7"><a href="databases.html#cb17-7"></a><span class="kw">colnames</span>(flu_dengue) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;month&quot;</span>,<span class="st">&quot;year&quot;</span>,<span class="st">&quot;disease&quot;</span>, <span class="st">&quot;activity&quot;</span>)</span>
<span id="cb17-8"><a href="databases.html#cb17-8"></a></span>
<span id="cb17-9"><a href="databases.html#cb17-9"></a><span class="co">#Functie voor plot van verloop activity</span></span>
<span id="cb17-10"><a href="databases.html#cb17-10"></a>activity_years_func &lt;-<span class="st"> </span><span class="cf">function</span>(dataset,name){</span>
<span id="cb17-11"><a href="databases.html#cb17-11"></a>  dataset <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(disease<span class="op">==</span>name) <span class="op">%&gt;%</span></span>
<span id="cb17-12"><a href="databases.html#cb17-12"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>month,<span class="dt">y=</span>activity, <span class="dt">group=</span>year, <span class="dt">color=</span><span class="kw">factor</span>(year)))<span class="op">+</span></span>
<span id="cb17-13"><a href="databases.html#cb17-13"></a><span class="st">    </span><span class="kw">geom_line</span>()<span class="op">+</span></span>
<span id="cb17-14"><a href="databases.html#cb17-14"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Month&quot;</span>, <span class="dt">breaks=</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>), <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">12</span>))<span class="op">+</span></span>
<span id="cb17-15"><a href="databases.html#cb17-15"></a><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>)<span class="op">+</span></span>
<span id="cb17-16"><a href="databases.html#cb17-16"></a><span class="st">    </span><span class="kw">theme_minimal</span>()</span>
<span id="cb17-17"><a href="databases.html#cb17-17"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="databases.html#cb18-1"></a><span class="kw">activity_years_func</span>(flu_dengue,<span class="st">&quot;flu&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="databases.html#cb19-1"></a><span class="kw">activity_years_func</span>(flu_dengue,<span class="st">&quot;dengue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="het-citeren-van-andere-werken.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-packages.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
