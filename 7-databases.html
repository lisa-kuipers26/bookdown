<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="7 Databases | Portofolio data science" />
<meta property="og:type" content="book" />

<meta property="og:description" content="Portflio" />
<meta name="github-repo" content="lisa-kuipers26" />

<meta name="author" content="Lisa Kuipers" />

<meta name="date" content="2022-06-28" />


<meta name="description" content="Portflio">

<title>7 Databases | Portofolio data science</title>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<link rel="stylesheet" href="my-styles.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#introductie"><span class="toc-section-number">1</span> Introductie</a></li>
<li><a href="2-verwerken-van-data.html#verwerken-van-data"><span class="toc-section-number">2</span> Verwerken van data</a></li>
<li class="has-sub"><a href="3-open-peer-review.html#open-peer-review"><span class="toc-section-number">3</span> Open Peer Review</a><ul>
<li class="has-sub"><a href="3.1-onderzoek-op-reproduceerbaarheid-beoordelen.html#onderzoek-op-reproduceerbaarheid-beoordelen"><span class="toc-section-number">3.1</span> Onderzoek op reproduceerbaarheid beoordelen</a><ul>
<li><a href="3.1-onderzoek-op-reproduceerbaarheid-beoordelen.html#omschrijving-onderzoek"><span class="toc-section-number">3.1.1</span> Omschrijving onderzoek</a></li>
<li><a href="3.1-onderzoek-op-reproduceerbaarheid-beoordelen.html#beoordeling-artikel"><span class="toc-section-number">3.1.2</span> Beoordeling artikel</a></li>
</ul></li>
<li class="has-sub"><a href="3.2-code-zelf-reproduceren.html#code-zelf-reproduceren"><span class="toc-section-number">3.2</span> Code zelf reproduceren</a><ul>
<li><a href="3.2-code-zelf-reproduceren.html#beoordeling-script"><span class="toc-section-number">3.2.1</span> Beoordeling script</a></li>
<li><a href="3.2-code-zelf-reproduceren.html#probleem-in-script"><span class="toc-section-number">3.2.2</span> Probleem in script</a></li>
</ul></li>
</ul></li>
<li><a href="4-data-organiseren.html#data-organiseren"><span class="toc-section-number">4</span> Data organiseren</a></li>
<li><a href="5-cv.html#cv"><span class="toc-section-number">5</span> cv</a></li>
<li><a href="6-het-citeren-van-andere-werken.html#het-citeren-van-andere-werken"><span class="toc-section-number">6</span> Het citeren van andere werken</a></li>
<li><a href="7-databases.html#databases"><span class="toc-section-number">7</span> Databases</a></li>
<li class="has-sub"><a href="8-r-packages.html#r-packages"><span class="toc-section-number">8</span> R packages</a><ul>
<li><a href="8.1-installeren-van-package.html#installeren-van-package"><span class="toc-section-number">8.1</span> Installeren van package</a></li>
<li><a href="8.2-package-gebruiken.html#package-gebruiken"><span class="toc-section-number">8.2</span> Package gebruiken</a></li>
<li><a href="8.3-functies.html#functies"><span class="toc-section-number">8.3</span> Functies</a></li>
<li><a href="8.4-data.html#data"><span class="toc-section-number">8.4</span> Data</a></li>
<li><a href="8.5-vignette.html#vignette"><span class="toc-section-number">8.5</span> Vignette</a></li>
</ul></li>
<li><a href="9-parameters-voor-flexibiliteit.html#parameters-voor-flexibiliteit"><span class="toc-section-number">9</span> Parameters voor flexibiliteit</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="databases" class="section level1">
<h1><span class="header-section-number">7</span> Databases</h1>
<p>Om wat verschillende functies van de database te laten zien worden er verschillende datasets ingeladen. Hieronder wordt de data van de dengue en flu google trends tidy gemaakt, door de landnamen in één kolom te zetten. Ook wordt er een aparte kolom gemaakt met de naam van de ziekte. Voorderest worden ook de datum opgesplitst in dagen, maanden en jaren zodat deze later samengevoegd kunnen worden met de gapminder data.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="7-databases.html#cb6-1"></a><span class="kw">library</span>(dslabs)</span>
<span id="cb6-2"><a href="7-databases.html#cb6-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb6-3"><a href="7-databases.html#cb6-3"></a></span>
<span id="cb6-4"><a href="7-databases.html#cb6-4"></a><span class="co">#laden van gapminder</span></span>
<span id="cb6-5"><a href="7-databases.html#cb6-5"></a>gapminder_df &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>()</span>
<span id="cb6-6"><a href="7-databases.html#cb6-6"></a></span>
<span id="cb6-7"><a href="7-databases.html#cb6-7"></a></span>
<span id="cb6-8"><a href="7-databases.html#cb6-8"></a><span class="co">#tidy maken van data functie</span></span>
<span id="cb6-9"><a href="7-databases.html#cb6-9"></a>tidy_func &lt;-<span class="st"> </span><span class="cf">function</span>(path,name){</span>
<span id="cb6-10"><a href="7-databases.html#cb6-10"></a>  read_df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(path, <span class="dt">skip=</span><span class="dv">11</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</span>
<span id="cb6-11"><a href="7-databases.html#cb6-11"></a>  col_nam &lt;-<span class="st"> </span><span class="kw">colnames</span>(read_df)</span>
<span id="cb6-12"><a href="7-databases.html#cb6-12"></a>  read_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span>col_nam[<span class="op">-</span><span class="dv">1</span>], <span class="dt">names_to=</span><span class="st">&quot;country&quot;</span>, <span class="dt">values_to=</span><span class="kw">paste0</span>(<span class="st">&quot;activity&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb6-13"><a href="7-databases.html#cb6-13"></a><span class="st">    </span><span class="kw">separate</span>(Date, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>,<span class="st">&quot;day&quot;</span>),<span class="dt">convert =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="st">&quot;disease&quot;</span>=name)</span>
<span id="cb6-14"><a href="7-databases.html#cb6-14"></a>}</span>
<span id="cb6-15"><a href="7-databases.html#cb6-15"></a></span>
<span id="cb6-16"><a href="7-databases.html#cb6-16"></a>dengue_tidy &lt;-<span class="st"> </span><span class="kw">tidy_func</span>(<span class="st">&quot;data/dengue_data.csv&quot;</span>,<span class="st">&quot;dengue&quot;</span>)</span>
<span id="cb6-17"><a href="7-databases.html#cb6-17"></a>flu_tidy &lt;-<span class="st"> </span><span class="kw">tidy_func</span>(<span class="st">&quot;data/flu_data.csv&quot;</span>,<span class="st">&quot;flu&quot;</span>)</span>
<span id="cb6-18"><a href="7-databases.html#cb6-18"></a></span>
<span id="cb6-19"><a href="7-databases.html#cb6-19"></a>flu_tidy <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">filter</span>(year<span class="op">==</span><span class="dv">2005</span>)</span>
<span id="cb6-20"><a href="7-databases.html#cb6-20"></a><span class="co">#opslaan als RDS</span></span>
<span id="cb6-21"><a href="7-databases.html#cb6-21"></a><span class="kw">saveRDS</span>(dengue_tidy, <span class="dt">file =</span> <span class="st">&quot;data/dengue_tidy.rds&quot;</span>)</span>
<span id="cb6-22"><a href="7-databases.html#cb6-22"></a><span class="kw">saveRDS</span>(flu_tidy, <span class="dt">file =</span> <span class="st">&quot;data/flu_tidy.rds&quot;</span>)</span>
<span id="cb6-23"><a href="7-databases.html#cb6-23"></a><span class="kw">saveRDS</span>(gapminder_df, <span class="dt">file =</span> <span class="st">&quot;data/gapminder.rds&quot;</span>)</span>
<span id="cb6-24"><a href="7-databases.html#cb6-24"></a></span>
<span id="cb6-25"><a href="7-databases.html#cb6-25"></a><span class="co">#opslaan als CSV</span></span>
<span id="cb6-26"><a href="7-databases.html#cb6-26"></a><span class="kw">write.csv</span>(gapminder_df,<span class="st">&quot;data/gapminder.csv&quot;</span>)</span>
<span id="cb6-27"><a href="7-databases.html#cb6-27"></a><span class="kw">write.csv</span>(dengue_tidy,<span class="st">&quot;data/dengue_tidy.csv&quot;</span>)</span>
<span id="cb6-28"><a href="7-databases.html#cb6-28"></a><span class="kw">write.csv</span>(flu_tidy,<span class="st">&quot;data/flu_tidy.csv&quot;</span>)</span></code></pre></div>
<p>Er moet een database gemaakt worden om de tabellen op te slaan. Hieronder staat SQL code die ingevoerd kan worden bij het programma dBeaver (of een andere database software) voor het creëren van een database.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb7-1"><a href="7-databases.html#cb7-1"></a><span class="kw">CREATE</span> <span class="kw">DATABASE</span> workflows;</span></code></pre></div>
<p>Om de database te gebruiken in R wordt er een connectie aangemaakt. Met de connectie kan R code gebruikt worden voor interactie met de database. Dit is handig omdat er dan niet steeds tussen twee programma’s hoeft te switchen. Via de connectie worden de verschillende tabellen ingeladen in de database.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="7-databases.html#cb8-1"></a><span class="kw">library</span>(DBI)</span>
<span id="cb8-2"><a href="7-databases.html#cb8-2"></a></span>
<span id="cb8-3"><a href="7-databases.html#cb8-3"></a><span class="co">#Connectie opzetten</span></span>
<span id="cb8-4"><a href="7-databases.html#cb8-4"></a>con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(RPostgres<span class="op">::</span><span class="kw">Postgres</span>(), </span>
<span id="cb8-5"><a href="7-databases.html#cb8-5"></a>                 <span class="dt">dbname =</span> <span class="st">&quot;workflows&quot;</span>, </span>
<span id="cb8-6"><a href="7-databases.html#cb8-6"></a>                 <span class="dt">host=</span><span class="st">&quot;localhost&quot;</span>, </span>
<span id="cb8-7"><a href="7-databases.html#cb8-7"></a>                 <span class="dt">port=</span><span class="st">&quot;5432&quot;</span>, </span>
<span id="cb8-8"><a href="7-databases.html#cb8-8"></a>                 <span class="dt">user=</span><span class="st">&quot;postgres&quot;</span>,</span>
<span id="cb8-9"><a href="7-databases.html#cb8-9"></a>                 <span class="dt">password=</span><span class="st">&quot;Datascience&quot;</span>)</span>
<span id="cb8-10"><a href="7-databases.html#cb8-10"></a></span>
<span id="cb8-11"><a href="7-databases.html#cb8-11"></a><span class="co">#Aanmaken van tabellen in databse</span></span>
<span id="cb8-12"><a href="7-databases.html#cb8-12"></a><span class="kw">dbWriteTable</span>(con, <span class="st">&quot;flu&quot;</span>, flu_tidy)</span>
<span id="cb8-13"><a href="7-databases.html#cb8-13"></a><span class="kw">dbWriteTable</span>(con, <span class="st">&quot;dengue&quot;</span>, dengue_tidy)</span>
<span id="cb8-14"><a href="7-databases.html#cb8-14"></a><span class="kw">dbWriteTable</span>(con, <span class="st">&quot;gapminder&quot;</span>, gapminder_df) B   bBññn ñ</span></code></pre></div>
<p>Om de gapminder wat netter te maken heb ik ervoor gekozen om alvast de landen en jaren die niet in de flu en dengue google trend data voorkomt te verwijderen.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="7-databases.html#cb9-1"></a><span class="co">#Jaren verwijderen die niet aanwezig zijn in flu en dengue</span></span>
<span id="cb9-2"><a href="7-databases.html#cb9-2"></a>gapminder_minyear &lt;-<span class="st"> </span>gapminder_df[gapminder_df<span class="op">$</span>year <span class="op">&gt;=</span><span class="st"> </span><span class="kw">min</span>(flu_tidy<span class="op">$</span>year), ]</span>
<span id="cb9-3"><a href="7-databases.html#cb9-3"></a>gapminder_maxyear &lt;-<span class="st"> </span>gapminder_minyear[gapminder_minyear<span class="op">$</span>year <span class="op">&lt;=</span><span class="st"> </span><span class="kw">max</span>(flu_tidy<span class="op">$</span>year), ]</span>
<span id="cb9-4"><a href="7-databases.html#cb9-4"></a></span>
<span id="cb9-5"><a href="7-databases.html#cb9-5"></a><span class="co">#Landen weghalen die niet en flu en dengue aanwezig zijn</span></span>
<span id="cb9-6"><a href="7-databases.html#cb9-6"></a>landen &lt;-<span class="st"> </span><span class="kw">c</span>(dengue_tidy<span class="op">$</span>country, flu_tidy<span class="op">$</span>country,<span class="dt">recursive=</span><span class="ot">TRUE</span>)</span>
<span id="cb9-7"><a href="7-databases.html#cb9-7"></a>gapminder_clean &lt;-<span class="st"> </span><span class="kw">subset</span>(gapminder_maxyear, country <span class="op">%in%</span><span class="st"> </span>landen)</span></code></pre></div>
<p>De oude tabel gapminder wordt via de connectie verwijderd en de nette wordt ingevoerd</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="7-databases.html#cb10-1"></a><span class="co">#Oude tabel verwijderen en nieuwe tabel invoegen</span></span>
<span id="cb10-2"><a href="7-databases.html#cb10-2"></a><span class="kw">dbRemoveTable</span>(con, <span class="st">&quot;gapminder&quot;</span>)</span>
<span id="cb10-3"><a href="7-databases.html#cb10-3"></a><span class="kw">dbWriteTable</span>(con, <span class="st">&quot;gapminder&quot;</span>, gapminder_clean)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb11-1"><a href="7-databases.html#cb11-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> flu_dengue</span>
<span id="cb11-2"><a href="7-databases.html#cb11-2"></a><span class="kw">AS</span></span>
<span id="cb11-3"><a href="7-databases.html#cb11-3"></a></span>
<span id="cb11-4"><a href="7-databases.html#cb11-4"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb11-5"><a href="7-databases.html#cb11-5"></a><span class="kw">FROM</span> </span>
<span id="cb11-6"><a href="7-databases.html#cb11-6"></a>  flu </span>
<span id="cb11-7"><a href="7-databases.html#cb11-7"></a></span>
<span id="cb11-8"><a href="7-databases.html#cb11-8"></a><span class="kw">UNION</span> <span class="kw">ALL</span></span>
<span id="cb11-9"><a href="7-databases.html#cb11-9"></a> </span>
<span id="cb11-10"><a href="7-databases.html#cb11-10"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb11-11"><a href="7-databases.html#cb11-11"></a> </span>
<span id="cb11-12"><a href="7-databases.html#cb11-12"></a><span class="kw">FROM</span></span>
<span id="cb11-13"><a href="7-databases.html#cb11-13"></a>  dengue</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb12-1"><a href="7-databases.html#cb12-1"></a><span class="kw">create</span> <span class="kw">table</span> all_data</span>
<span id="cb12-2"><a href="7-databases.html#cb12-2"></a><span class="kw">as</span></span>
<span id="cb12-3"><a href="7-databases.html#cb12-3"></a></span>
<span id="cb12-4"><a href="7-databases.html#cb12-4"></a><span class="kw">select</span> </span>
<span id="cb12-5"><a href="7-databases.html#cb12-5"></a>gapminder.<span class="op">*</span>,</span>
<span id="cb12-6"><a href="7-databases.html#cb12-6"></a>flu_dengue.<span class="ot">&quot;month&quot;</span>,</span>
<span id="cb12-7"><a href="7-databases.html#cb12-7"></a>flu_dengue.<span class="ot">&quot;day&quot;</span>,</span>
<span id="cb12-8"><a href="7-databases.html#cb12-8"></a>flu_dengue.disease,</span>
<span id="cb12-9"><a href="7-databases.html#cb12-9"></a>flu_dengue.activity</span>
<span id="cb12-10"><a href="7-databases.html#cb12-10"></a></span>
<span id="cb12-11"><a href="7-databases.html#cb12-11"></a><span class="kw">from</span> gapminder </span>
<span id="cb12-12"><a href="7-databases.html#cb12-12"></a><span class="kw">left</span> <span class="kw">join</span> flu_dengue</span>
<span id="cb12-13"><a href="7-databases.html#cb12-13"></a><span class="kw">on</span> flu_dengue.<span class="ot">&quot;year&quot;</span> <span class="op">=</span> gapminder.<span class="ot">&quot;year&quot;</span> <span class="kw">and</span> flu_dengue.country <span class="op">=</span> gapminder.country</span>
<span id="cb12-14"><a href="7-databases.html#cb12-14"></a>    </span>
<span id="cb12-15"><a href="7-databases.html#cb12-15"></a><span class="kw">ORDER</span> <span class="kw">BY</span> gapminder.<span class="ot">&quot;year&quot;</span>, gapminder.country, flu_dengue.<span class="ot">&quot;month&quot;</span>, flu_dengue.<span class="ot">&quot;day&quot;</span>  ;</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="7-databases.html#cb13-1"></a><span class="co">#Data uit DB ophalen</span></span>
<span id="cb13-2"><a href="7-databases.html#cb13-2"></a>all_data &lt;-<span class="st"> </span><span class="kw">dbReadTable</span>(con, <span class="st">&quot;all_data&quot;</span>)</span>
<span id="cb13-3"><a href="7-databases.html#cb13-3"></a><span class="co">#Dataset opslaan in data </span></span>
<span id="cb13-4"><a href="7-databases.html#cb13-4"></a><span class="kw">saveRDS</span>(all_data, <span class="dt">file=</span><span class="st">&quot;data/all_data.rds&quot;</span>)</span>
<span id="cb13-5"><a href="7-databases.html#cb13-5"></a><span class="co">#Connectie met database sluiten</span></span>
<span id="cb13-6"><a href="7-databases.html#cb13-6"></a><span class="kw">dbDisconnect</span>(con) </span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="7-databases.html#cb14-1"></a><span class="co">#Data laden voor analyse</span></span>
<span id="cb14-2"><a href="7-databases.html#cb14-2"></a>all_data &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data/all_data.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="7-databases.html#cb15-1"></a><span class="kw">library</span>(gridExtra)</span>
<span id="cb15-2"><a href="7-databases.html#cb15-2"></a></span>
<span id="cb15-3"><a href="7-databases.html#cb15-3"></a>populatie_func &lt;-<span class="st"> </span><span class="cf">function</span>(dataset,year,name){</span>
<span id="cb15-4"><a href="7-databases.html#cb15-4"></a>  country_data &lt;-<span class="st"> </span>dataset <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year<span class="op">==</span><span class="dv">2008</span>, disease<span class="op">==</span>name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-5"><a href="7-databases.html#cb15-5"></a><span class="st">    </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-6"><a href="7-databases.html#cb15-6"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="kw">mean</span>(activity, <span class="dt">na.rm=</span><span class="ot">TRUE</span>), <span class="kw">max</span>(population),<span class="kw">max</span>(gdp))</span>
<span id="cb15-7"><a href="7-databases.html#cb15-7"></a>  <span class="kw">colnames</span>(country_data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;country&quot;</span>,<span class="st">&quot;activity&quot;</span>,<span class="st">&quot;population&quot;</span>,<span class="st">&quot;GDP&quot;</span>)</span>
<span id="cb15-8"><a href="7-databases.html#cb15-8"></a>  country_data[<span class="kw">order</span>(country_data<span class="op">$</span>population, <span class="dt">decreasing=</span><span class="ot">TRUE</span>),]</span>
<span id="cb15-9"><a href="7-databases.html#cb15-9"></a>  </span>
<span id="cb15-10"><a href="7-databases.html#cb15-10"></a>  </span>
<span id="cb15-11"><a href="7-databases.html#cb15-11"></a>  plot1 &lt;-<span class="st"> </span>country_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>country, <span class="dt">y=</span>population))<span class="op">+</span></span>
<span id="cb15-12"><a href="7-databases.html#cb15-12"></a><span class="st">    </span><span class="kw">geom_col</span>()<span class="op">+</span></span>
<span id="cb15-13"><a href="7-databases.html#cb15-13"></a><span class="st">    </span><span class="kw">theme_minimal</span>()<span class="op">+</span></span>
<span id="cb15-14"><a href="7-databases.html#cb15-14"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">vjust=</span><span class="fl">0.3</span>,<span class="dt">hjust=</span><span class="dv">1</span>))</span>
<span id="cb15-15"><a href="7-databases.html#cb15-15"></a>  plot2 &lt;-<span class="st"> </span>country_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>country, <span class="dt">y=</span>GDP))<span class="op">+</span></span>
<span id="cb15-16"><a href="7-databases.html#cb15-16"></a><span class="st">    </span><span class="kw">geom_col</span>()<span class="op">+</span></span>
<span id="cb15-17"><a href="7-databases.html#cb15-17"></a><span class="st">    </span><span class="kw">theme_minimal</span>()<span class="op">+</span></span>
<span id="cb15-18"><a href="7-databases.html#cb15-18"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">vjust=</span><span class="fl">0.3</span>,<span class="dt">hjust=</span><span class="dv">1</span>))</span>
<span id="cb15-19"><a href="7-databases.html#cb15-19"></a>  plot3 &lt;-<span class="st"> </span>country_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>country, <span class="dt">y=</span>activity))<span class="op">+</span></span>
<span id="cb15-20"><a href="7-databases.html#cb15-20"></a><span class="st">    </span><span class="kw">geom_col</span>()<span class="op">+</span></span>
<span id="cb15-21"><a href="7-databases.html#cb15-21"></a><span class="st">    </span><span class="kw">theme_minimal</span>()<span class="op">+</span></span>
<span id="cb15-22"><a href="7-databases.html#cb15-22"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>,<span class="dt">vjust=</span><span class="fl">0.3</span>,<span class="dt">hjust=</span><span class="dv">1</span>))</span>
<span id="cb15-23"><a href="7-databases.html#cb15-23"></a>  </span>
<span id="cb15-24"><a href="7-databases.html#cb15-24"></a>  <span class="kw">grid.arrange</span>(plot1,plot2,plot3)</span>
<span id="cb15-25"><a href="7-databases.html#cb15-25"></a>}</span>
<span id="cb15-26"><a href="7-databases.html#cb15-26"></a></span>
<span id="cb15-27"><a href="7-databases.html#cb15-27"></a><span class="kw">populatie_func</span>(all_data, <span class="dv">2008</span>, <span class="st">&quot;flu&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/data%20analyse%20populatie-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="7-databases.html#cb16-1"></a><span class="kw">populatie_func</span>(all_data, <span class="dv">2008</span>, <span class="st">&quot;dengue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/data%20analyse%20populatie-2.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="7-databases.html#cb17-1"></a><span class="kw">library</span>(RColorBrewer)</span>
<span id="cb17-2"><a href="7-databases.html#cb17-2"></a></span>
<span id="cb17-3"><a href="7-databases.html#cb17-3"></a><span class="co">#Summarise van data per year </span></span>
<span id="cb17-4"><a href="7-databases.html#cb17-4"></a>flu_dengue &lt;-<span class="st"> </span>all_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(month, year, disease) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-5"><a href="7-databases.html#cb17-5"></a><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year<span class="op">!=</span><span class="dv">2002</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-6"><a href="7-databases.html#cb17-6"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="kw">mean</span>(activity))</span>
<span id="cb17-7"><a href="7-databases.html#cb17-7"></a><span class="kw">colnames</span>(flu_dengue) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;month&quot;</span>,<span class="st">&quot;year&quot;</span>,<span class="st">&quot;disease&quot;</span>, <span class="st">&quot;activity&quot;</span>)</span>
<span id="cb17-8"><a href="7-databases.html#cb17-8"></a></span>
<span id="cb17-9"><a href="7-databases.html#cb17-9"></a><span class="co">#Functie voor plot van verloop activity</span></span>
<span id="cb17-10"><a href="7-databases.html#cb17-10"></a>activity_years_func &lt;-<span class="st"> </span><span class="cf">function</span>(dataset,name){</span>
<span id="cb17-11"><a href="7-databases.html#cb17-11"></a>  dataset <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(disease<span class="op">==</span>name) <span class="op">%&gt;%</span></span>
<span id="cb17-12"><a href="7-databases.html#cb17-12"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>month,<span class="dt">y=</span>activity, <span class="dt">group=</span>year, <span class="dt">color=</span><span class="kw">factor</span>(year)))<span class="op">+</span></span>
<span id="cb17-13"><a href="7-databases.html#cb17-13"></a><span class="st">    </span><span class="kw">geom_line</span>()<span class="op">+</span></span>
<span id="cb17-14"><a href="7-databases.html#cb17-14"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Month&quot;</span>, <span class="dt">breaks=</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>), <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">12</span>))<span class="op">+</span></span>
<span id="cb17-15"><a href="7-databases.html#cb17-15"></a><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>)<span class="op">+</span></span>
<span id="cb17-16"><a href="7-databases.html#cb17-16"></a><span class="st">    </span><span class="kw">theme_minimal</span>()</span>
<span id="cb17-17"><a href="7-databases.html#cb17-17"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="7-databases.html#cb18-1"></a><span class="kw">activity_years_func</span>(flu_dengue,<span class="st">&quot;flu&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="7-databases.html#cb19-1"></a><span class="kw">activity_years_func</span>(flu_dengue,<span class="st">&quot;dengue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>

</div>
<p style="text-align: center;">
<a href="6-het-citeren-van-andere-werken.html"><button class="btn btn-default">Previous</button></a>
<a href="8-r-packages.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
